
; Storm C Compiler
; Developer:eXtropia/eXtropiaNG/proj/gfxTest/drawtest.cpp
	mc68030
	mc68881
	XREF	_cos__r
	XREF	loadImage__ImageLoader__P11ImageBufferPCcE
	XREF	loadImage__ImageLoader__P11ImageBufferPCc
	XREF	loadPPM__TextureLoader__P07TexturePCcE
	XREF	writeBytes__StreamOut__TPvUi
	XREF	close__StreamOut__T
	XREF	open__StreamOut__TPCcssUi
	XREF	rawReadBytes__StreamOut__TPvUij
	XREF	readBytes__StreamIn__TPvUi
	XREF	close__StreamIn__T
	XREF	open__StreamIn__TPCcsUi
	XREF	rawWriteBytes__StreamIn__TPvUij
	XREF	destroy__AsyncStreamBuffer__T
	XREF	sendPacket__AsyncStreamBuffer__TPv
	XREF	waitPacket__AsyncStreamBuffer__T
	XREF	_0dt__Texture__T
	XREF	_0ct__Texture__T
	XREF	associate__Texture__TP10Rasterizer
	XREF	_0dt__Rasterizer__T
	XREF	drawTriMesh2__Rasterizer__TUiUiUi
	XREF	drawTriMesh__Rasterizer__TUiUiUi
	XREF	setVertices__Rasterizer__TP10DrawVertex
	XREF	createZBuffer__Rasterizer__T
	XREF	setFront__Rasterizer__TE
	XREF	obtain__Rasterizer__P07Surface
	XREF	destroy__Mesh__T
	XREF	create__Mesh__TUsUs
	XREF	getDrawSurface__Display__T
	XREF	setTitle__Display__TPCc
	XREF	refresh__Display__T
	XREF	waitSync__Display__T
	XREF	close__Display__T
	XREF	reopen__Display__T
	XREF	open__Display__TP17DisplayPropertiesPCc
	XREF	open__Display__TssEPCc
	XREF	_0dt__NativeScreenDB__T
	XREF	_0ct__NativeScreenDB__T
	XREF	refresh__NativeScreenDB__T
	XREF	close__NativeScreenDB__T
	XREF	reopen__NativeScreenDB__T
	XREF	open__NativeScreenDB__TP17DisplayPropertiesPCc
	XREF	open__NativeScreenDB__TssEPCc
	XREF	_0dt__NativeScreen__T
	XREF	_0ct__NativeScreen__T
	XREF	close__NativeScreen__T
	XREF	reopen__NativeScreen__T
	XREF	open__NativeScreen__TP17DisplayPropertiesPCc
	XREF	open__NativeScreen__TssEPCc
	XREF	_0dt__NativeWindow__T
	XREF	_0ct__NativeWindow__T
	XREF	refresh__NativeWindow__T
	XREF	close__NativeWindow__T
	XREF	open__NativeWindow__TP17DisplayPropertiesPCc
	XREF	open__NativeWindow__TssEPCc
	XREF	reopen__NativeWindow__T
	XREF	setTitle__DisplayNative__TPCcs
	XREF	waitForRefresh__DisplayNative__T
	XREF	destroy__Surface__T
	XREF	blitCopy__Surface__P07SurfacessP07Surfacessss
	XREF	create__Surface__TssP06BitMap
	XREF	init__Surface__T
	XREF	getHardwareFormat__Native2D__E
	XREF	done__GfxLib_
	XREF	init__GfxLib_
	XREF	findIndex__DisplayPropertiesProvider__ssEs
	XREF	getMode__DisplayPropertiesProvider__Ui
	XREF	_0ct__ImageBuffer__T
	XREF	destroy__ImageBuffer__T
	XREF	create__ImageBuffer__TssEP07Palettess
	XREF	_0dt__Lockable__T
	XREF	sleep__Thread__Ujsss
	XREF	_0dt__Threadable__T
	XREF	run__Threadable__T
	XREF	elapsed__MilliClock__T
	XREF	runApplication__AppBase__T
	XREF	getSwitch__AppBase__PCcs
	XREF	getInteger__AppBase__PCcs
	XREF	getString__AppBase__PCcs
	XREF	dialogueBox__SystemLib__PCcPCcPCce
	XREF	_sprintf
	XREF	_printf
	XREF	_puts
	XREF	_system
	XREF	op__delete__PvUi
	XREF	op__new__Ui
	XREF	_std__in
	XREF	_std__out
	XREF	_std__err
	XREF	_SysBase
	XREF	_IntuitionBase
	XREF	_debug__SystemLib
	XREF	_allocated__Mem
	XREF	_volatileBuff__Mem
	XREF	_totalSize__Mem
	XREF	_nextFree__Mem
	XREF	_count__Mem
	XREF	_maxAllocs__Mem
	XREF	_TimerBase
	XREF	_clockFreq__MilliClock
	XREF	_DOSBase
	XREF	_threadCnt__Threadable
	XREF	_threadsIdle__Threadable
	XREF	_rootThread__Threadable
	XREF	_priTab__Threadable
	XREF	_propTab__PixelDescriptor
	XREF	_modesAvail__DisplayPropertiesProvider
	XREF	_numModes__DisplayPropertiesProvider
	XREF	_GfxBase
	XREF	_CyberGfxBase
	XREF	_pixelType__Native2D
	XREF	_convTab__Native2D
	XREF	_modeID__DisplayNative
	XREF	_Warp3DBase
	XREF	_state__Native3D
	XREF	_query__Native3D
	XREF	_alphaTest__Native3D
	XREF	_zBuffTest__Native3D
	XREF	_logicOp__Native3D
	XREF	_fogMode__Native3D
	XREF	_blendMode__Native3D
	XREF	_frontFace__Native3D
	XREF	_texel__Native3D
	XREF	_texEnv__Native3D
	XREF	_texFill__Native3D
	XREF	_texFilter__Native3D
	XREF	_coordType__Native3D
	XREF	_colourType__Native3D
	XREF	_texCoordType__Native3D
	XREF	_openCnt__Rasterizer
	XREF	_drawPointsXYZ_F32__Rasterizer
	XREF	_drawPointsXYZ_F64__Rasterizer
	XREF	_drawLinesXYZ_F32__Rasterizer
	XREF	_drawLinesXYZ_F64__Rasterizer
	XREF	_drawLineStripXYZ_F32__Rasterizer
	XREF	_drawLineStripXYZ_F64__Rasterizer
	XREF	_useArrayEmul__Rasterizer

	SECTION "getVolatile__Mem_:0",CODE

	rts

	SECTION "op__plus__R04TimeR04Time:0",CODE


;Time operator+(Time& a, Time& b)
	XDEF	op__plus__R04TimeR04Time
op__plus__R04TimeR04Time
L95	EQU	-$10
	link	a5,#L95
L94
;	Time sum(a.totMillis() + b.totMillis());
	clr.l	-$8(a5)
	clr.l	-4(a5)
;	return sum;
	move.l	-$8(a5),d0
	move.l	-4(a5),d1
	move.l	$8(a5),a0
	move.l	d0,(a0)
	move.l	d1,4(a0)
	unlk	a5
	rts

	SECTION "op__minus__R04TimeR04Time:0",CODE


;Time operator-(Time& a, Time& b)
	XDEF	op__minus__R04TimeR04Time
op__minus__R04TimeR04Time
L97	EQU	-$10
	link	a5,#L97
L96
;	Time diff(a.totMillis() - b.totMillis());
	clr.l	-$8(a5)
	clr.l	-4(a5)
;	return diff;
	move.l	-$8(a5),d0
	move.l	-4(a5),d1
	move.l	$8(a5),a0
	move.l	d0,(a0)
	move.l	d1,4(a0)
	unlk	a5
	rts

	SECTION "_redBalance__Colour:1",DATA

_redBalance__Colour
	dc.w	$4D

	SECTION "_greenBalance__Colour:1",DATA

_greenBalance__Colour
	dc.w	$96

	SECTION "_blueBalance__Colour:1",DATA

_blueBalance__Colour
	dc.w	$1C

	SECTION "_text__GfxTestApp:0",CODE


	XDEF	_INIT_8_drawtest_cpp__text__GfxTestApp
_INIT_8_drawtest_cpp__text__GfxTestApp
L101
;char GfxTestApp::text[64] = {0};
	move.l	#_text__GfxTestApp,a0
	lea	1(a0),a0
	moveq	#$3E,d0
L102
	clr.b	(a0)+
	dbra	d0,L102
	rts

	SECTION "_text__GfxTestApp:1",DATA

	XDEF	_text__GfxTestApp
_text__GfxTestApp
	dc.b	0
	ds.b	63

	SECTION "init__AppBase_:0",CODE


;sint32 AppBase::init()
	XDEF	init__AppBase_
init__AppBase_
L103
;	return GfxLib::init();
	jsr	init__GfxLib_
	rts

	SECTION "done__AppBase_:0",CODE


;void AppBase::done()
	XDEF	done__AppBase_
done__AppBase_
L104
;	GfxLib::done();
	jsr	done__GfxLib_
	rts

	SECTION "createApplicationInstance__AppBase_:0",CODE


;AppBase* AppBase::createApplicationInstance()
	XDEF	createApplicationInstance__AppBase_
createApplicationInstance__AppBase_
	move.l	d2,-(a7)
L105
;	return new GfxTestApp;
	pea	$2E.w
	jsr	op__new__Ui
	move.l	d0,d2
	addq.w	#4,a7
	move.l	d2,a0
	cmp.w	#0,a0
	beq.b	L107
L106
	move.l	d2,a1
	move.l	#_0virttab__10GfxTestApp__10GfxTestApp,(a1)
	move.l	d2,-(a7)
	jsr	_0ct__GfxTestApp__T
	addq.w	#4,a7
L107
	move.l	d2,d0
	move.l	(a7)+,d2
	rts

	SECTION "destroyApplicationInstance__AppBase__P07AppBase:0",CODE


;void AppBase::destroyApplicationInstance(AppBase* app)
	XDEF	destroyApplicationInstance__AppBase__P07AppBase
destroyApplicationInstance__AppBase__P07AppBase
	move.l	a2,-(a7)
	move.l	$8(a7),a2
L108
;	delete app;
	cmp.w	#0,a2
	beq.b	L110
L109
	move.l	(a2),a0
	move.l	a2,d0
	add.l	$C(a0),d0
	move.l	d0,-(a7)
	move.l	$8(a0),a0
	jsr	(a0)
	addq.w	#4,a7
	move.l	(a2),a0
	move.l	(a0),-(a7)
	move.l	4(a0),d0
	add.l	a2,d0
	move.l	d0,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L110
	move.l	(a7)+,a2
	rts

	SECTION "_0ct__GfxTestApp__T:0",CODE


;GfxTestApp::GfxTestApp() 
	XDEF	_0ct__GfxTestApp__T
_0ct__GfxTestApp__T
	movem.l	d2/d3/a2/a6,-(a7)
	move.l	$14(a7),a2
L118
	move.l	_TimerBase,a6
	lea	$8(a2),a0
	jsr	-$3C(a6)
	move.l	d0,_clockFreq__MilliClock
	move.l	a2,a1
	clr.l	$18(a1)
	move.l	a2,a1
	clr.l	$1C(a1)
	move.l	a2,a1
	clr.l	$20(a1)
	move.l	a2,a1
	clr.l	$24(a1)
;	texName		= (char*)getString("usetex", false);
	clr.w	-(a7)
	move.l	#L111,-(a7)
	jsr	getString__AppBase__PCcs
	addq.w	#6,a7
	move.l	a2,a1
	move.l	d0,4(a1)
;	width			= Clamp::integer(getInteger("width", false), 320, 1024);
	move.l	#$400,d3
	move.l	#$140,d2
	clr.w	-(a7)
	move.l	#L112,-(a7)
	jsr	getInteger__AppBase__PCcs
	addq.w	#6,a7
	cmp.l	d2,d0
	bge.b	L120
L119
	move.l	d2,d0
	bra.b	L124
L120
	cmp.l	d3,d0
	ble.b	L122
L121
	move.l	d3,d0
L122
L123
L124
	move.l	a2,a0
	move.l	d0,$10(a0)
;	height		= Clamp::integer(getInteger("height", false), 240, 768);
	move.l	#$300,d3
	move.l	#$F0,d2
	clr.w	-(a7)
	move.l	#L113,-(a7)
	jsr	getInteger__AppBase__PCcs
	addq.w	#6,a7
	cmp.l	d2,d0
	bge.b	L126
L125
	move.l	d2,d0
	bra.b	L130
L126
	cmp.l	d3,d0
	ble.b	L128
L127
	move.l	d3,d0
L128
L129
L130
	move.l	a2,a0
	move.l	d0,$14(a0)
;	flat			= getSwitch("flat", false);
	clr.w	-(a7)
	move.l	#L114,-(a7)
	jsr	getSwitch__AppBase__PCcs
	addq.w	#6,a7
	move.l	a2,a0
	move.w	d0,$28(a0)
;	cull			= getSwitch("cull", false);
	clr.w	-(a7)
	move.l	#L115,-(a7)
	jsr	getSwitch__AppBase__PCcs
	addq.w	#6,a7
	move.l	a2,a0
	move.w	d0,$2A(a0)
;	zbuff			= getSwitch("zbuff", false);
	clr.w	-(a7)
	move.l	#L116,-(a7)
	jsr	getSwitch__AppBase__PCcs
	addq.w	#6,a7
	move.l	a2,a0
	move.w	d0,$2C(a0)
;	vertices	= new DrawVertex[MESH_MAX*MESH_MAX];
	move.l	#$80000,-(a7)
	jsr	op__new__Ui
	addq.w	#4,a7
	move.l	a2,a1
	move.l	d0,$24(a1)
;	appDisplay = new DisplayWindow();
	pea	$60.w
	jsr	op__new__Ui
	move.l	d0,d2
	addq.w	#4,a7
	move.l	d2,a0
	cmp.w	#0,a0
	beq.b	L132
L131
	move.l	d2,a0
	move.l	#_0virttab__13DisplayWindow__13DisplayWindow,(a0)+
	move.l	a0,-(a7)
	jsr	_0ct__NativeWindow__T
	addq.w	#4,a7
L132
	move.l	a2,a1
	move.l	d2,$18(a1)
;	printf("\n\nRasterizer test application log file\n" \
	move.l	#L117,-(a7)
	jsr	_printf
	addq.w	#4,a7
	movem.l	(a7)+,d2/d3/a2/a6
	rts

L117
	dc.b	$A,$A,'Rasterizer test application log file',$A
	dc.b	'----------------------------------------------',$A,0
L115
	dc.b	'cull',0
L114
	dc.b	'flat',0
L113
	dc.b	'height',0
L111
	dc.b	'usetex',0
L112
	dc.b	'width',0
L116
	dc.b	'zbuff',0

	SECTION "_0dt__GfxTestApp__T:0",CODE


;GfxTestApp::~GfxTestApp()
	XDEF	_0dt__GfxTestApp__T
_0dt__GfxTestApp__T
	movem.l	a2/a3,-(a7)
	move.l	$C(a7),a2
L133
;	if (tex)
	tst.l	$1C(a2)
	beq.b	L136
L134
;		delete tex;
	move.l	$1C(a2),a3
	move.l	a3,a0
	cmp.w	#0,a0
	beq.b	L136
L135
	move.l	a3,-(a7)
	jsr	_0dt__Texture__T
	addq.w	#4,a7
	pea	$24.w
	move.l	a3,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L136
;	if (gfx)
	tst.l	$20(a2)
	beq.b	L139
L137
;		delete gfx;
	move.l	$20(a2),a3
	move.l	a3,a0
	cmp.w	#0,a0
	beq.b	L139
L138
	move.l	a3,-(a7)
	jsr	_0dt__Rasterizer__T
	addq.w	#4,a7
	pea	$AC.w
	move.l	a3,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L139
;	if (vertices)
	tst.l	$24(a2)
	beq.b	L142
L140
;		delete[] vertices;
	move.l	$24(a2),a0
	cmp.w	#0,a0
	beq.b	L142
L141
	move.l	#-$2A,-(a7)
	move.l	a0,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L142
;	if (appDisplay)
	tst.l	$18(a2)
	beq.b	L145
L143
;		delete appDisplay;
	move.l	$18(a2),a2
	cmp.w	#0,a2
	beq.b	L145
L144
	move.l	(a2),a0
	move.l	a2,d0
	add.l	$5C(a0),d0
	move.l	d0,-(a7)
	move.l	$58(a0),a0
	jsr	(a0)
	addq.w	#4,a7
	move.l	(a2),a0
	move.l	$50(a0),-(a7)
	move.l	$54(a0),d0
	add.l	a2,d0
	move.l	d0,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L145
	movem.l	(a7)+,a2/a3
	rts

	SECTION "genMesh__GfxTestApp__Tjj:0",CODE


;void GfxTestApp::genMesh(sint32 dx, sint32 dy)
	XDEF	genMesh__GfxTestApp__Tjj
genMesh__GfxTestApp__Tjj
L169	EQU	-$40
	link	a5,#L169
	movem.l	d2-d6/a2/a3,-(a7)
	fmovem.x fp2/fp3/fp4/fp5/fp6/fp7,-(a7)
	movem.l	$C(a5),d4/d5
	move.l	$8(a5),a3
L147
;	dx = Clamp::integer(dx, MESH_MIN, MESH_MAX);
	move.l	#$80,d2
	moveq	#$10,d1
	move.l	d4,d0
	cmp.l	d1,d0
	bge.b	L149
L148
	move.l	d1,d4
	bra.b	L153
L149
	cmp.l	d2,d0
	ble.b	L151
L150
	move.l	d2,d4
	bra.b	L152
L151
	move.l	d0,d4
L152
L153
;	dy = Clamp::integer(dy, MESH_MIN, MESH_MAX);
	move.l	#$80,d2
	moveq	#$10,d1
	move.l	d5,d0
	cmp.l	d1,d0
	bge.b	L155
L154
	move.l	d1,d5
	bra.b	L159
L155
	cmp.l	d2,d0
	ble.b	L157
L156
	move.l	d2,d5
	bra.b	L158
L157
	move.l	d0,d5
L158
L159
;	sprintf(text, "Calculating mesh %ld x %ld...", dx, dy);
	move.l	d5,-(a7)
	move.l	d4,-(a7)
	move.l	#L146,-(a7)
	move.l	#_text__GfxTestApp,-(a7)
	jsr	_sprintf
	add.w	#$10,a7
;	appDisplay->setTitle(text);
	move.l	#_text__GfxTestApp,-(a7)
	move.l	a3,a1
	move.l	$18(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$6C(a1),d0
	move.l	d0,-(a7)
	move.l	$68(a1),a1
	jsr	(a1)
	addq.w	#$8,a7
;	float32 nx = 4.0*PI/(float32)width;
	move.l	a3,a0
	fmove.l	$10(a0),fp0
	fmove.d	#$.402921FB.54442D0F,fp1
	fdiv.x	fp0,fp1
	fmove.x	fp1,fp0
	fmove.s	fp0,-4(a5)
;	float32 ny = 4.0*PI/(float32)height;
	move.l	a3,a0
	fmove.l	$14(a0),fp0
	fmove.d	#$.402921FB.54442D0F,fp1
	fdiv.x	fp0,fp1
	fmove.x	fp1,fp0
	fmove.s	fp0,-$8(a5)
;	float32 sx = ((float32)width)/(float32)(dx-1);
	move.l	a3,a0
	fmove.l	$10(a0),fp0
	fmove.s	fp0,fp7
	move.l	d4,d0
	subq.l	#1,d0
	fmove.l	d0,fp0
	fmove.x	fp7,fp1
	fdiv.x	fp0,fp1
	fmove.s	fp1,fp7
;	float32 sy = ((float32)height)/(float32)(dy-1);
	move.l	a3,a0
	fmove.l	$14(a0),fp0
	fmove.s	fp0,-$10(a5)
	move.l	d5,d0
	subq.l	#1,d0
	fmove.l	d0,fp0
	fmove.s	-$10(a5),fp1
	fdiv.x	fp0,fp1
	fmove.s	fp1,-$10(a5)
;	float32 fy = 0.0;
	fmove.s	#$.00000000,fp4
;	DrawVertex* p = vertices;
	move.l	a3,a0
	move.l	$24(a0),a2
;	for (sint32 y=0;
	moveq	#0,d3
	bra	L167
L160
;		float32 fx = 0.0;
	fmove.s	#$.00000000,fp2
;		for (sint32 x=0;
	moveq	#0,d2
	bra	L165
L161
;			p->x = fx;
	fmove.s	fp2,(a2)
; p->y = fy;
	fmove.s	fp4,4(a2)
;			float32 tmpx = nx*(fx - 0.5*(float32)width);
	fmove.s	-4(a5),fp0
	fmove.x	fp2,fp1
	move.l	a3,a0
	fmove.l	$10(a0),fp3
	fmul.d	#$.3FE00000.00000000,fp3
	fsub.x	fp3,fp1
	fmul.x	fp1,fp0
;			float32 tmpy = ny*(fy - 0.5*(float32)height);
	fmove.s	-$8(a5),fp1
	fmove.x	fp4,fp3
	move.l	a3,a0
	fmove.l	$14(a0),fp5
	fmul.d	#$.3FE00000.00000000,fp5
	fsub.x	fp5,fp3
	fmul.x	fp3,fp1
;			p->z = 0.5 + (0.45*cos((tmpx*tmpx)+(tmpy*tmpy)));
	fmove.x	fp0,fp3
	fmul.x	fp0,fp3
	fmove.x	fp3,fp0
	fmove.x	fp1,fp3
	fmul.x	fp1,fp3
	fadd.x	fp3,fp0
	fmove.d	fp0,-(a7)
	jsr	_cos__r
	addq.w	#$8,a7
	fmul.d	#$.3FDCCCCC.CCCCCCCD,fp0
	fadd.d	#$.3FE00000.00000000,fp0
	fmove.s	fp0,$8(a2)
;			p->w = 0;
	clr.l	$C(a2)
; p->u = fx;
	fmove.s	fp2,$10(a2)
; p->v = fy;
	fmove.s	fp4,$14(a2)
;			if ((x&1)^(y&1))
	move.l	d2,d0
	and.l	#1,d0
	move.l	d3,d1
	and.l	#1,d1
	eor.l	d1,d0
	tst.l	d0
	beq	L163
L162
;				Colour tmpc = 0xFF000000 | (uint32)(255.0*(fx/(float3
	move.l	a3,a1
	fmove.l	$10(a1),fp0
	fmove.x	fp2,fp1
	fdiv.x	fp0,fp1
	fmove.x	fp1,fp0
	fmul.d	#$.406FE000.00000000,fp0
	fmove.l	fp0,d0
	lea	-$30(a5),a0
	or.l	#-$1000000,d0
	move.l	d0,(a0)
;				tmpc.scale(p->z);
	fmove.s	$8(a2),fp1
	lea	-$30(a5),a0
	moveq	#0,d0
	move.b	1(a0),d0
	fmove.l	d0,fp0
	fmul.x	fp1,fp0
	fmove.l	fp0,d0
	move.b	d0,1(a0)
	moveq	#0,d0
	move.b	2(a0),d0
	fmove.l	d0,fp0
	fmul.x	fp1,fp0
	fmove.l	fp0,d0
	move.b	d0,2(a0)
	moveq	#0,d0
	move.b	3(a0),d0
	fmove.l	d0,fp0
	fmul.x	fp1,fp0
	fmove.l	fp0,d0
	move.b	d0,3(a0)
;				p->colour = (uint32)tmpc | (uint32)(128.0*(fx/(float32)width)
	move.l	a3,a0
	fmove.l	$10(a0),fp0
	fmove.x	fp2,fp1
	fdiv.x	fp0,fp1
	fmove.x	fp1,fp0
	fmul.d	#$.40600000.00000000,fp0
	fmove.l	fp0,d0
	moveq	#$8,d6
	asl.l	d6,d0
	move.l	-$30(a5),d1
	or.l	d0,d1
	move.l	d1,$18(a2)
	bra	L164
L163
;				Colour tmpc = 0xFF000000 | ((uint32)(255.0*(fx/(float
	move.l	a3,a1
	fmove.l	$10(a1),fp0
	fmove.x	fp2,fp1
	fdiv.x	fp0,fp1
	fmove.x	fp1,fp0
	fmul.d	#$.406FE000.00000000,fp0
	fmove.l	fp0,d0
	moveq	#$10,d1
	asl.l	d1,d0
	lea	-$30(a5),a0
	or.l	#-$1000000,d0
	move.l	d0,(a0)
;				tmpc.scale(p->z);
	fmove.s	$8(a2),fp1
	lea	-$30(a5),a0
	moveq	#0,d0
	move.b	1(a0),d0
	fmove.l	d0,fp0
	fmul.x	fp1,fp0
	fmove.l	fp0,d0
	move.b	d0,1(a0)
	moveq	#0,d0
	move.b	2(a0),d0
	fmove.l	d0,fp0
	fmul.x	fp1,fp0
	fmove.l	fp0,d0
	move.b	d0,2(a0)
	moveq	#0,d0
	move.b	3(a0),d0
	fmove.l	d0,fp0
	fmul.x	fp1,fp0
	fmove.l	fp0,d0
	move.b	d0,3(a0)
;				p->colour = (uint32)tmpc | (uint32)(64.0*(fx/(float32)width))
	move.l	a3,a0
	fmove.l	$10(a0),fp0
	fmove.x	fp2,fp1
	fdiv.x	fp0,fp1
	fmove.x	fp1,fp0
	fmul.d	#$.40500000.00000000,fp0
	fmove.l	fp0,d0
	moveq	#$8,d6
	asl.l	d6,d0
	move.l	-$30(a5),d1
	or.l	d0,d1
	move.l	d1,$18(a2)
L164
;			p++;
	add.w	#$20,a2
	addq.l	#1,d2
	fadd.x	fp7,fp2
L165
	cmp.l	d4,d2
	blt	L161
L166
	addq.l	#1,d3
	fadd.s	-$10(a5),fp4
L167
	cmp.l	d5,d3
	blt	L160
L168
	fmovem.x (a7)+,fp2/fp3/fp4/fp5/fp6/fp7
	movem.l	(a7)+,d2-d6/a2/a3
	unlk	a5
	rts

L146
	dc.b	'Calculating mesh %ld x %ld...',0

	SECTION "testMesh1__GfxTestApp__T:0",CODE


;void GfxTestApp::testMesh1()
	XDEF	testMesh1__GfxTestApp__T
testMesh1__GfxTestApp__T
	movem.l	d2-d5/a2/a3/a6,-(a7)
	fmovem.x fp2,-(a7)
	move.l	$2C(a7),a2
L173
;	printf("Row   Col   Draw Area    Time   Tris/s  MPix/s\n" \
	move.l	#L170,-(a7)
	jsr	_printf
	addq.w	#4,a7
;	for (sint32 i=MESH_MIN;
	moveq	#$10,d2
	bra	L182
L174
;		genMesh(i, i);
	move.l	d2,-(a7)
	move.l	d2,-(a7)
	move.l	a2,-(a7)
	jsr	genMesh__GfxTestApp__Tjj
	add.w	#$C,a7
;		sprintf(text, "Drawing %ld x %ld...", i, i);
	move.l	d2,-(a7)
	move.l	d2,-(a7)
	move.l	#L171,-(a7)
	move.l	#_text__GfxTestApp,-(a7)
	jsr	_sprintf
	add.w	#$10,a7
;		appDisplay->setTitle(text);
	move.l	#_text__GfxTestApp,-(a7)
	move.l	a2,a1
	move.l	$18(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$6C(a1),d0
	move.l	d0,-(a7)
	move.l	$68(a1),a1
	jsr	(a1)
	addq.w	#$8,a7
;		if (gfx->lock())
	move.l	a2,a0
	move.l	$20(a0),a3
	move.l	a3,a0
	move.l	$A8(a0),d0
	and.l	#2,d0
	beq.b	L176
L175
	moveq	#1,d4
	bra.b	L179
L176
	move.l	a3,a1
	move.l	_Warp3DBase,a6
	move.l	(a1),a0
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L178
L177
	move.l	a3,a0
	move.l	$A8(a0),d0
	or.l	#2,d0
	move.l	a3,a0
	move.l	d0,$A8(a0)
	moveq	#1,d4
L178
L179
	tst.w	d4
	beq.b	L181
L180
;			timer.set();
	move.l	_TimerBase,a6
	lea	$8(a2),a0
	jsr	-$3C(a6)
;			gfx->drawTriMesh(0, i, i);
	move.l	d2,-(a7)
	move.l	d2,-(a7)
	clr.l	-(a7)
	move.l	a2,a1
	move.l	$20(a1),-(a7)
	jsr	drawTriMesh__Rasterizer__TUiUiUi
	add.w	#$10,a7
;			timeTaken = timer.elapsed();
	pea	$8(a2)
	jsr	elapsed__MilliClock__T
	addq.w	#4,a7
	move.l	d0,d3
;			gfx->flush();
	move.l	a2,a1
	move.l	$20(a1),a0
	move.l	_Warp3DBase,a6
	move.l	(a0),a0
	jsr	-$1B0(a6)
;			gfx->unlock();
	move.l	a2,a1
	move.l	$20(a1),a0
	and.l	#-3,$A8(a0)
	move.l	_Warp3DBase,a6
	move.l	(a0),a0
	jsr	-$42(a6)
;			appDisplay->refresh();
	move.l	a2,a1
	move.l	$18(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$74(a1),d0
	move.l	d0,-(a7)
	move.l	$70(a1),a1
	jsr	(a1)
	addq.w	#4,a7
L181
;		uint32 tris = (uint32)((1000f*2*(i-1)*(i-1))/(float32)timeTaken);
	move.l	d2,d0
	subq.l	#1,d0
	fmove.l	d0,fp0
	fmul.s	#$.44FA0000,fp0
	move.l	d2,d0
	subq.l	#1,d0
	fmove.l	d0,fp1
	fmul.x	fp1,fp0
	fmove.l	d3,fp1
	fdiv.x	fp1,fp0
	fmove.l	fp0,d5
;		float32 mpx = (width*height)/((float32)timeTaken*1000f);
	move.l	a2,a0
	move.l	$10(a0),d0
	move.l	a2,a0
	muls.l	$14(a0),d0
	fmove.l	d0,fp1
	fmove.l	d3,fp0
	fmul.s	#$.447A0000,fp0
	fdiv.x	fp0,fp1
;		printf("%3ld x %3ld %5ld x %3ld %4lu ms %8lu %8.4f\n", i, i, \
	fmove.x	fp1,fp0
	fmove.d	fp0,-(a7)
	move.l	d5,-(a7)
	move.l	d3,-(a7)
	move.l	a2,a0
	move.l	$14(a0),-(a7)
	move.l	a2,a0
	move.l	$10(a0),-(a7)
	move.l	d2,-(a7)
	move.l	d2,-(a7)
	move.l	#L172,-(a7)
	jsr	_printf
	add.w	#$24,a7
	add.l	#$10,d2
L182
	cmp.l	#$80,d2
	ble	L174
L183
	fmovem.x (a7)+,fp2
	movem.l	(a7)+,d2-d5/a2/a3/a6
	rts

L172
	dc.b	'%3ld x %3ld %5ld x %3ld %4lu ms %8lu %8.4f',$A,0
L171
	dc.b	'Drawing %ld x %ld...',0
L170
	dc.b	'Row   Col   Draw Area    Time   Tris/s  MPix/s',$A
	dc.b	'----------------------------------------------',$A,0

	SECTION "testMesh2__GfxTestApp__T:0",CODE


;void GfxTestApp::testMesh2()
	XDEF	testMesh2__GfxTestApp__T
testMesh2__GfxTestApp__T
	movem.l	d2-d5/a2/a3/a6,-(a7)
	fmovem.x fp2,-(a7)
	move.l	$2C(a7),a2
L187
;	printf("Row   Col   Draw Area    Time   Tris/s  MPix/s\n" \
	move.l	#L184,-(a7)
	jsr	_printf
	addq.w	#4,a7
;	for (sint32 i=MESH_MIN;
	moveq	#$10,d2
	bra	L196
L188
;		genMesh(i, i);
	move.l	d2,-(a7)
	move.l	d2,-(a7)
	move.l	a2,-(a7)
	jsr	genMesh__GfxTestApp__Tjj
	add.w	#$C,a7
;		sprintf(text, "Drawing %ld x %ld...", i, i);
	move.l	d2,-(a7)
	move.l	d2,-(a7)
	move.l	#L185,-(a7)
	move.l	#_text__GfxTestApp,-(a7)
	jsr	_sprintf
	add.w	#$10,a7
;		appDisplay->setTitle(text);
	move.l	#_text__GfxTestApp,-(a7)
	move.l	a2,a1
	move.l	$18(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$6C(a1),d0
	move.l	d0,-(a7)
	move.l	$68(a1),a1
	jsr	(a1)
	addq.w	#$8,a7
;		if (gfx->lock())
	move.l	a2,a0
	move.l	$20(a0),a3
	move.l	a3,a0
	move.l	$A8(a0),d0
	and.l	#2,d0
	beq.b	L190
L189
	moveq	#1,d4
	bra.b	L193
L190
	move.l	a3,a1
	move.l	_Warp3DBase,a6
	move.l	(a1),a0
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L192
L191
	move.l	a3,a0
	move.l	$A8(a0),d0
	or.l	#2,d0
	move.l	a3,a0
	move.l	d0,$A8(a0)
	moveq	#1,d4
L192
L193
	tst.w	d4
	beq.b	L195
L194
;			timer.set();
	move.l	_TimerBase,a6
	lea	$8(a2),a0
	jsr	-$3C(a6)
;			gfx->drawTriMesh2(0, i, i);
	move.l	d2,-(a7)
	move.l	d2,-(a7)
	clr.l	-(a7)
	move.l	a2,a1
	move.l	$20(a1),-(a7)
	jsr	drawTriMesh2__Rasterizer__TUiUiUi
	add.w	#$10,a7
;			timeTaken = timer.elapsed();
	pea	$8(a2)
	jsr	elapsed__MilliClock__T
	addq.w	#4,a7
	move.l	d0,d3
;			gfx->flush();
	move.l	a2,a1
	move.l	$20(a1),a0
	move.l	_Warp3DBase,a6
	move.l	(a0),a0
	jsr	-$1B0(a6)
;			gfx->unlock();
	move.l	a2,a1
	move.l	$20(a1),a0
	and.l	#-3,$A8(a0)
	move.l	_Warp3DBase,a6
	move.l	(a0),a0
	jsr	-$42(a6)
;			appDisplay->refresh();
	move.l	a2,a1
	move.l	$18(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$74(a1),d0
	move.l	d0,-(a7)
	move.l	$70(a1),a1
	jsr	(a1)
	addq.w	#4,a7
L195
;		uint32 tris = (uint32)((1000f*2*(i-1)*(i-1))/(float32)timeTaken);
	move.l	d2,d0
	subq.l	#1,d0
	fmove.l	d0,fp0
	fmul.s	#$.44FA0000,fp0
	move.l	d2,d0
	subq.l	#1,d0
	fmove.l	d0,fp1
	fmul.x	fp1,fp0
	fmove.l	d3,fp1
	fdiv.x	fp1,fp0
	fmove.l	fp0,d5
;		float32 mpx = (width*height)/((float32)timeTaken*1000f);
	move.l	a2,a0
	move.l	$10(a0),d0
	move.l	a2,a0
	muls.l	$14(a0),d0
	fmove.l	d0,fp1
	fmove.l	d3,fp0
	fmul.s	#$.447A0000,fp0
	fdiv.x	fp0,fp1
;		printf("%3ld x %3ld %5ld x %3ld %4lu ms %8lu %8.4f\n", i, i, \
	fmove.x	fp1,fp0
	fmove.d	fp0,-(a7)
	move.l	d5,-(a7)
	move.l	d3,-(a7)
	move.l	a2,a0
	move.l	$14(a0),-(a7)
	move.l	a2,a0
	move.l	$10(a0),-(a7)
	move.l	d2,-(a7)
	move.l	d2,-(a7)
	move.l	#L186,-(a7)
	jsr	_printf
	add.w	#$24,a7
	add.l	#$10,d2
L196
	cmp.l	#$80,d2
	ble	L188
L197
	fmovem.x (a7)+,fp2
	movem.l	(a7)+,d2-d5/a2/a3/a6
	rts

L186
	dc.b	'%3ld x %3ld %5ld x %3ld %4lu ms %8lu %8.4f',$A,0
L185
	dc.b	'Drawing %ld x %ld...',0
L184
	dc.b	'Row   Col   Draw Area    Time   Tris/s  MPix/s',$A
	dc.b	'----------------------------------------------',$A,0

	SECTION "dumpPixelInfo__GfxTestApp__TP15PixelDescriptor:0",CODE


;void GfxTestApp::dumpPixelInfo(PixelDescriptor *pxl)
	XDEF	dumpPixelInfo__GfxTestApp__TP15PixelDescriptor
dumpPixelInfo__GfxTestApp__TP15PixelDescriptor
	move.l	a2,-(a7)
	move.l	$C(a7),a2
L205
;	printf("\nBytes   : %lu, endian %s\n",
	tst.b	3(a2)
	beq.b	L207
L206
	moveq	#1,d0
	bra.b	L208
L207
	moveq	#0,d0
L208
	tst.w	d0
	beq.b	L210
L209
	move.l	#L198,a0
	bra.b	L211
L210
	move.l	#L199,a0
L211
	move.l	a0,-(a7)
	moveq	#0,d0
	move.b	(a2),d0
	move.l	d0,-(a7)
	move.l	#L200,-(a7)
	jsr	_printf
	add.w	#$C,a7
;	printf("Bits    : A[%3lu] R[%3lu] G[%3lu] B[%3lu]\n",
	moveq	#0,d0
	move.b	7(a2),d0
	move.l	d0,-(a7)
	moveq	#0,d0
	move.b	6(a2),d0
	move.l	d0,-(a7)
	moveq	#0,d0
	move.b	5(a2),d0
	move.l	d0,-(a7)
	moveq	#0,d0
	move.b	4(a2),d0
	move.l	d0,-(a7)
	move.l	#L201,-(a7)
	jsr	_printf
	add.w	#$14,a7
;	printf("Offsets : A[%3lu] R[%3lu] G[%3lu] B[%3lu]\n",
	moveq	#0,d0
	move.b	$B(a2),d0
	move.l	d0,-(a7)
	moveq	#0,d0
	move.b	$A(a2),d0
	move.l	d0,-(a7)
	moveq	#0,d0
	move.b	$9(a2),d0
	move.l	d0,-(a7)
	moveq	#0,d0
	move.b	$8(a2),d0
	move.l	d0,-(a7)
	move.l	#L202,-(a7)
	jsr	_printf
	add.w	#$14,a7
;	printf("Maxima  : A[%3lu] R[%3lu] G[%3lu] B[%3lu]\n",
	moveq	#0,d0
	move.b	7(a2),d0
	moveq	#1,d1
	asl.l	d0,d1
	move.l	d1,d0
	subq.l	#1,d0
	move.l	d0,-(a7)
	moveq	#0,d0
	move.b	6(a2),d0
	moveq	#1,d1
	asl.l	d0,d1
	move.l	d1,d0
	subq.l	#1,d0
	move.l	d0,-(a7)
	moveq	#0,d0
	move.b	5(a2),d0
	moveq	#1,d1
	asl.l	d0,d1
	move.l	d1,d0
	subq.l	#1,d0
	move.l	d0,-(a7)
	moveq	#0,d0
	move.b	4(a2),d0
	moveq	#1,d1
	asl.l	d0,d1
	move.l	d1,d0
	subq.l	#1,d0
	move.l	d0,-(a7)
	move.l	#L203,-(a7)
	jsr	_printf
	add.w	#$14,a7
;	printf("\n");
	move.l	#L204,-(a7)
	jsr	_printf
	addq.w	#4,a7
	move.l	(a7)+,a2
	rts

L204
	dc.b	$A,0
L200
	dc.b	$A,'Bytes   : %lu, endian %s',$A,0
L201
	dc.b	'Bits    : A[%3lu] R[%3lu] G[%3lu] B[%3lu]',$A,0
L203
	dc.b	'Maxima  : A[%3lu] R[%3lu] G[%3lu] B[%3lu]',$A,0
L202
	dc.b	'Offsets : A[%3lu] R[%3lu] G[%3lu] B[%3lu]',$A,0
L199
	dc.b	'native',0
L198
	dc.b	'swapped',0

	SECTION "initApplication__GfxTestApp__T:0",CODE


;sint32 GfxTestApp::initApplication()
	XDEF	initApplication__GfxTestApp__T
initApplication__GfxTestApp__T
	movem.l	d2/a2/a3,-(a7)
	move.l	$10(a7),a2
L223
;	if (!appDisplay)
	tst.l	$18(a2)
	bne.b	L225
L224
;		puts("***error: Unable to create window");
	move.l	#L212,-(a7)
	jsr	_puts
	addq.w	#4,a7
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,d2/a2/a3
	rts
L225
;	if (!vertices)
	tst.l	$24(a2)
	bne.b	L227
L226
;		puts("***error: Unable to allocate vertex buffer");
	move.l	#L213,-(a7)
	jsr	_puts
	addq.w	#4,a7
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,d2/a2/a3
	rts
L227
;	if (appDisplay->open(width, height, Pixel::BPP15, "DrawTest")!=OK)
	move.l	#L214,-(a7)
	pea	$F.w
	move.w	$16(a2),-(a7)
	move.w	$12(a2),-(a7)
	move.l	$18(a2),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$9C(a1),d0
	move.l	d0,-(a7)
	move.l	$98(a1),a1
	jsr	(a1)
	add.w	#$10,a7
	tst.l	d0
	beq.b	L229
L228
;		puts("***error: Unable to open window");
	move.l	#L215,-(a7)
	jsr	_puts
	addq.w	#4,a7
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,d2/a2/a3
	rts
L229
;	if ( !(gfx = G3D::getRasterizer(appDisplay->getDrawSurface())) )
	move.l	$18(a2),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$64(a1),d0
	move.l	d0,-(a7)
	move.l	$60(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	move.l	d0,-(a7)
	jsr	obtain__Rasterizer__P07Surface
	addq.w	#4,a7
	move.l	d0,a0
	move.l	a0,$20(a2)
	cmp.w	#0,a0
	bne.b	L231
L230
;		puts("***error: Unable to obtain Rasterizer");
	move.l	#L216,-(a7)
	jsr	_puts
	addq.w	#4,a7
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,d2/a2/a3
	rts
L231
;	if (zbuff)
	tst.w	$2C(a2)
	beq.b	L234
L232
;		if (gfx->createZBuffer()==false)
	move.l	$20(a2),-(a7)
	jsr	createZBuffer__Rasterizer__T
	addq.w	#4,a7
	tst.w	d0
	bne.b	L234
L233
;			puts("\n***warning: unable to allocate z buffer\n");
	move.l	#L217,-(a7)
	jsr	_puts
	addq.w	#4,a7
;			zbuff = false;
	clr.w	$2C(a2)
L234
;	if (texName)
	tst.l	4(a2)
	beq.b	L241
L235
;		tex	= new Texture;
	pea	$24.w
	jsr	op__new__Ui
	move.l	d0,d2
	addq.w	#4,a7
	move.l	d2,a0
	cmp.w	#0,a0
	beq.b	L237
L236
	move.l	d2,-(a7)
	jsr	_0ct__Texture__T
	addq.w	#4,a7
L237
	move.l	d2,$1C(a2)
;		if (TextureLoader::loadPPM(tex, texName, G3D::TXL_ARGB32)!=OK)
	pea	$9.w
	move.l	4(a2),-(a7)
	move.l	$1C(a2),-(a7)
	jsr	loadPPM__TextureLoader__P07TexturePCcE
	add.w	#$C,a7
	tst.l	d0
	beq.b	L241
L238
;			printf("***warning: Failed to load image %s\n", texName);
	move.l	4(a2),-(a7)
	move.l	#L218,-(a7)
	jsr	_printf
	addq.w	#$8,a7
;			delete tex;
	move.l	$1C(a2),a3
	move.l	a3,a0
	cmp.w	#0,a0
	beq.b	L240
L239
	move.l	a3,-(a7)
	jsr	_0dt__Texture__T
	addq.w	#4,a7
	pea	$24.w
	move.l	a3,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L240
;			tex = 0;
	clr.l	$1C(a2)
L241
;	if (tex && (tex->associate(gfx)!=OK))
	tst.l	$1C(a2)
	beq.b	L244
L242
	move.l	$20(a2),-(a7)
	move.l	$1C(a2),-(a7)
	jsr	associate__Texture__TP10Rasterizer
	addq.w	#$8,a7
	tst.l	d0
	beq.b	L244
L243
;		SystemLib::dialogueBox("Error", "Exit", "Unable to as
	move.l	#L219,-(a7)
	move.l	#L220,-(a7)
	move.l	#L221,-(a7)
	jsr	dialogueBox__SystemLib__PCcPCcPCce
	add.w	#$C,a7
;		puts("***error: Failed to associate texture");
	move.l	#L222,-(a7)
	jsr	_puts
	addq.w	#4,a7
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,d2/a2/a3
	rts
L244
;	return OK;
	moveq	#0,d0
	movem.l	(a7)+,d2/a2/a3
	rts

L217
	dc.b	$A,'***warning: unable to allocate z buffer',$A,0
L222
	dc.b	'***error: Failed to associate texture',0
L213
	dc.b	'***error: Unable to allocate vertex buffer',0
L212
	dc.b	'***error: Unable to create window',0
L216
	dc.b	'***error: Unable to obtain Rasterizer',0
L215
	dc.b	'***error: Unable to open window',0
L218
	dc.b	'***warning: Failed to load image %s',$A,0
L214
	dc.b	'DrawTest',0
L221
	dc.b	'Error',0
L220
	dc.b	'Exit',0
L219
	dc.b	'Unable to associate Texture',0

	SECTION "runApplication__GfxTestApp__T:0",CODE


;sint32 GfxTestApp::runApplication()
	XDEF	runApplication__GfxTestApp__T
runApplication__GfxTestApp__T
L325	EQU	-$30
	link	a5,#L325
	movem.l	d2-d4/a2/a3/a6,-(a7)
	move.l	$8(a5),a3
L261
;	gfx->setVertices(vertices);
	move.l	a3,a1
	move.l	$24(a1),-(a7)
	move.l	a3,a1
	move.l	$20(a1),-(a7)
	jsr	setVertices__Rasterizer__TP10DrawVertex
	addq.w	#$8,a7
;	printf("Display Properties\nWidth: %d, Height: %d, Modulus: %d\n",
	move.l	a3,a1
	move.l	$18(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$64(a1),d0
	move.l	d0,-(a7)
	move.l	$60(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	move.l	d0,a0
	move.w	$22(a0),d0
	ext.l	d0
	move.l	d0,-(a7)
	move.l	a3,a0
	move.l	$14(a0),-(a7)
	move.l	a3,a0
	move.l	$10(a0),-(a7)
	move.l	#L245,-(a7)
	jsr	_printf
	add.w	#$10,a7
;	printf("\nPixel format\n");
	move.l	#L246,-(a7)
	jsr	_printf
	addq.w	#4,a7
;	dumpPixelInfo(appDisplay->getDrawSurface()->getDescriptor());
	move.l	a3,a1
	move.l	$18(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$64(a1),d0
	move.l	d0,-(a7)
	move.l	$60(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	move.l	d0,a0
	move.l	$26(a0),d0
	muls.l	#$C,d0
	move.l	#_propTab__PixelDescriptor,a1
	pea	0(a1,d0.l)
	move.l	a3,-(a7)
	jsr	dumpPixelInfo__GfxTestApp__TP15PixelDescriptor
	addq.w	#$8,a7
;	printf("\nStates shade:");
	move.l	#L247,-(a7)
	jsr	_printf
	addq.w	#4,a7
;	if (flat)
	move.l	a3,a0
	tst.w	$28(a0)
	beq.b	L266
L262
;		gfx->disable(G3D::GOURAUD);
	moveq	#4,d2
	move.l	a3,a0
	move.l	$20(a0),a2
	move.l	d2,d0
	move.l	#_state__Native3D,a1
	move.l	0(a1,d0.l*4),d0
	move.l	a2,a1
	move.l	_Warp3DBase,a6
	moveq	#2,d1
	move.l	(a1),a0
	jsr	-$30(a6)
	tst.l	d0
	bne.b	L264
L263
	moveq	#1,d1
	asl.l	d2,d1
	not.l	d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	and.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
	bra.b	L265
L264
	moveq	#1,d1
	asl.l	d2,d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	or.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
L265
;		printf("flat");
	move.l	#L248,-(a7)
	jsr	_printf
	addq.w	#4,a7
	bra.b	L270
L266
;		gfx->enable(G3D::GOURAUD);
	moveq	#4,d2
	move.l	a3,a0
	move.l	$20(a0),a2
	move.l	d2,d0
	move.l	#_state__Native3D,a1
	move.l	0(a1,d0.l*4),d0
	move.l	a2,a1
	move.l	_Warp3DBase,a6
	moveq	#1,d1
	move.l	(a1),a0
	jsr	-$30(a6)
	tst.l	d0
	bne.b	L268
L267
	moveq	#1,d1
	asl.l	d2,d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	or.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
	bra.b	L269
L268
	moveq	#1,d1
	asl.l	d2,d1
	not.l	d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	and.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
L269
;		printf("gouraud");
	move.l	#L249,-(a7)
	jsr	_printf
	addq.w	#4,a7
L270
;	printf(", cull:");
	move.l	#L250,-(a7)
	jsr	_printf
	addq.w	#4,a7
;	if (cull)
	move.l	a3,a0
	tst.w	$2A(a0)
	beq.b	L275
L271
;		gfx->setFront(G3D::FRONT_CCW);
	pea	1.w
	move.l	a3,a1
	move.l	$20(a1),-(a7)
	jsr	setFront__Rasterizer__TE
	addq.w	#$8,a7
;		gfx->enable(G3D::CULLING);
	moveq	#$11,d2
	move.l	a3,a0
	move.l	$20(a0),a2
	move.l	d2,d0
	move.l	#_state__Native3D,a1
	move.l	0(a1,d0.l*4),d0
	move.l	a2,a1
	move.l	_Warp3DBase,a6
	moveq	#1,d1
	move.l	(a1),a0
	jsr	-$30(a6)
	tst.l	d0
	bne.b	L273
L272
	moveq	#1,d1
	asl.l	d2,d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	or.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
	bra.b	L274
L273
	moveq	#1,d1
	asl.l	d2,d1
	not.l	d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	and.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
L274
;		printf("on (CCW)");
	move.l	#L251,-(a7)
	jsr	_printf
	addq.w	#4,a7
	bra.b	L279
L275
;		gfx->disable(G3D::CULLING);
	moveq	#$11,d2
	move.l	a3,a0
	move.l	$20(a0),a2
	move.l	d2,d0
	move.l	#_state__Native3D,a1
	move.l	0(a1,d0.l*4),d0
	move.l	a2,a1
	move.l	_Warp3DBase,a6
	moveq	#2,d1
	move.l	(a1),a0
	jsr	-$30(a6)
	tst.l	d0
	bne.b	L277
L276
	moveq	#1,d1
	asl.l	d2,d1
	not.l	d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	and.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
	bra.b	L278
L277
	moveq	#1,d1
	asl.l	d2,d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	or.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
L278
;		printf("off");
	move.l	#L252,-(a7)
	jsr	_printf
	addq.w	#4,a7
L279
;	printf(", zbuff:");
	move.l	#L253,-(a7)
	jsr	_printf
	addq.w	#4,a7
;	if (zbuff)
	move.l	a3,a0
	tst.w	$2C(a0)
	beq	L290
L280
;		gfx->enable(G3D::ZBUFTEST);
	moveq	#$8,d2
	move.l	a3,a0
	move.l	$20(a0),a2
	move.l	d2,d0
	move.l	#_state__Native3D,a1
	move.l	0(a1,d0.l*4),d0
	move.l	a2,a1
	move.l	_Warp3DBase,a6
	moveq	#1,d1
	move.l	(a1),a0
	jsr	-$30(a6)
	tst.l	d0
	bne.b	L282
L281
	moveq	#1,d1
	asl.l	d2,d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	or.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
	bra.b	L283
L282
	moveq	#1,d1
	asl.l	d2,d1
	not.l	d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	and.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
L283
;		gfx->enable(G3D::ZBUFWRITE);
	moveq	#$9,d2
	move.l	a3,a0
	move.l	$20(a0),a2
	move.l	d2,d0
	move.l	#_state__Native3D,a1
	move.l	0(a1,d0.l*4),d0
	move.l	a2,a1
	move.l	_Warp3DBase,a6
	moveq	#1,d1
	move.l	(a1),a0
	jsr	-$30(a6)
	tst.l	d0
	bne.b	L285
L284
	moveq	#1,d1
	asl.l	d2,d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	or.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
	bra.b	L286
L285
	moveq	#1,d1
	asl.l	d2,d1
	not.l	d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	and.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
L286
;		gfx->setZTest(G3D::ZTEST_LT);
	moveq	#0,d2
	move.l	a3,a0
	move.l	$20(a0),a2
	move.l	d2,d0
	move.l	#_zBuffTest__Native3D,a1
	moveq	#0,d1
	move.b	0(a1,d0.l),d1
	move.l	a2,a1
	move.l	_Warp3DBase,a6
	move.l	(a1),a0
	jsr	-$F6(a6)
	tst.l	d0
	bne.b	L288
L287
	move.l	a2,a0
	move.l	d2,$8C(a0)
L288
L289
;		printf("on (LESS/UPDATE)");
	move.l	#L254,-(a7)
	jsr	_printf
	addq.w	#4,a7
	bra.b	L291
L290
;		printf("off");
	move.l	#L252,-(a7)
	jsr	_printf
	addq.w	#4,a7
L291
;	printf(", tex:");
	move.l	#L255,-(a7)
	jsr	_printf
	addq.w	#4,a7
;	if (tex)
	move.l	a3,a1
	tst.l	$1C(a1)
	beq	L305
L292
;		tex->setEnvironment(G3D::MODULATE);
	moveq	#2,d2
	move.l	a3,a0
	move.l	$1C(a0),-$30(a5)
	move.l	-$30(a5),a1
	tst.l	4(a1)
	beq.b	L295
L293
	move.l	-$30(a5),a1
	tst.l	$8(a1)
	beq.b	L295
L294
	move.l	d2,d0
	move.l	#_texEnv__Native3D,a1
	moveq	#0,d1
	move.b	0(a1,d0.l),d1
	move.l	-$30(a5),a0
	move.l	$8(a0),a1
	move.l	-$30(a5),a2
	move.l	4(a2),a0
	move.l	_Warp3DBase,a6
	sub.l	a2,a2
	jsr	-$7E(a6)
L295
	move.l	-$30(a5),a0
	move.l	d2,$20(a0)
;		gfx->enable(G3D::TEXTURE);
	moveq	#0,d2
	move.l	a3,a0
	move.l	$20(a0),a2
	move.l	d2,d0
	move.l	#_state__Native3D,a1
	move.l	0(a1,d0.l*4),d0
	move.l	a2,a1
	move.l	_Warp3DBase,a6
	moveq	#1,d1
	move.l	(a1),a0
	jsr	-$30(a6)
	tst.l	d0
	bne.b	L297
L296
	moveq	#1,d1
	asl.l	d2,d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	or.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
	bra.b	L298
L297
	moveq	#1,d1
	asl.l	d2,d1
	not.l	d1
	move.l	a2,a0
	move.l	$A0(a0),d0
	and.l	d1,d0
	move.l	a2,a0
	move.l	d0,$A0(a0)
L298
;		gfx->setTexture(tex);
	move.l	a3,a0
	move.l	$1C(a0),a1
	move.l	a3,a2
	move.l	$20(a2),a0
	cmp.w	#0,a1
	bne.b	L300
L299
	clr.l	$8(a0)
	move.l	_Warp3DBase,a6
	moveq	#0,d0
	move.l	(a0),a0
	sub.l	a1,a1
	jsr	-$1FE(a6)
	bra.b	L304
L300
	move.l	4(a1),a2
	cmp.l	(a0),a2
	bne.b	L302
L301
	tst.l	$8(a1)
	bne.b	L303
L302
	bra.b	L304
L303
	move.l	a1,$8(a0)
	move.l	_Warp3DBase,a6
	moveq	#0,d0
	move.l	(a0),a0
	move.l	$8(a1),a1
	jsr	-$1FE(a6)
L304
;		printf("%s\n", texName);
	move.l	a3,a1
	move.l	4(a1),-(a7)
	move.l	#L256,-(a7)
	jsr	_printf
	addq.w	#$8,a7
	bra.b	L306
L305
;		printf("none\n");
	move.l	#L257,-(a7)
	jsr	_printf
	addq.w	#4,a7
L306
;	if (gfx->lock())
	move.l	a3,a0
	move.l	$20(a0),a2
	move.l	a2,a0
	move.l	$A8(a0),d0
	and.l	#2,d0
	beq.b	L308
L307
	moveq	#1,d4
	bra.b	L311
L308
	move.l	a2,a1
	move.l	_Warp3DBase,a6
	move.l	(a1),a0
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L310
L309
	move.l	a2,a0
	move.l	$A8(a0),d0
	or.l	#2,d0
	move.l	a2,a0
	move.l	d0,$A8(a0)
	moveq	#1,d4
L310
L311
	tst.w	d4
	beq	L315
L312
;		gfx->clearDrawArea(0x000000);
	clr.l	-$28(a5)
	move.l	a3,a0
	move.l	$20(a0),a1
	move.l	_Warp3DBase,a6
	move.l	-$28(a5),d0
	move.l	(a1),a0
	jsr	-$1C2(a6)
;		if (zbuff)
	move.l	a3,a0
	tst.w	$2C(a0)
	beq.b	L314
L313
;			gfx->clearZBuffer(1.0);
	move.l	#$3FF00000,-$1C(a5)
	clr.l	-$18(a5)
	move.l	a3,a1
	move.l	$20(a1),a0
	move.l	_Warp3DBase,a6
	move.l	(a0),a0
	lea	-$1C(a5),a1
	jsr	-$E4(a6)
L314
;		gfx->flush();
	move.l	a3,a1
	move.l	$20(a1),a0
	move.l	_Warp3DBase,a6
	move.l	(a0),a0
	jsr	-$1B0(a6)
;		gfx->unlock();
	move.l	a3,a1
	move.l	$20(a1),a0
	and.l	#-3,$A8(a0)
	move.l	_Warp3DBase,a6
	move.l	(a0),a0
	jsr	-$42(a6)
;		appDisplay->refresh();
	move.l	a3,a1
	move.l	$18(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$74(a1),d0
	move.l	d0,-(a7)
	move.l	$70(a1),a1
	jsr	(a1)
	addq.w	#4,a7
L315
;	printf("\nTesting Rasterizer::drawTriMesh()\n\n");
	move.l	#L258,-(a7)
	jsr	_printf
	addq.w	#4,a7
;	testMesh1();
	move.l	a3,-(a7)
	jsr	testMesh1__GfxTestApp__T
	addq.w	#4,a7
;	if (gfx->lock())
	move.l	a3,a0
	move.l	$20(a0),a2
	move.l	a2,a0
	move.l	$A8(a0),d0
	and.l	#2,d0
	beq.b	L317
L316
	moveq	#1,d3
	bra.b	L320
L317
	move.l	a2,a1
	move.l	_Warp3DBase,a6
	move.l	(a1),a0
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L319
L318
	move.l	a2,a0
	move.l	$A8(a0),d0
	or.l	#2,d0
	move.l	a2,a0
	move.l	d0,$A8(a0)
	moveq	#1,d3
L319
L320
	tst.w	d3
	beq	L324
L321
;		gfx->clearDrawArea(0x000000);
	clr.l	-$2C(a5)
	move.l	a3,a0
	move.l	$20(a0),a1
	move.l	_Warp3DBase,a6
	move.l	-$2C(a5),d0
	move.l	(a1),a0
	jsr	-$1C2(a6)
;		if (zbuff)
	move.l	a3,a0
	tst.w	$2C(a0)
	beq.b	L323
L322
;			gfx->clearZBuffer(1.0);
	move.l	#$3FF00000,-$24(a5)
	clr.l	-$20(a5)
	move.l	a3,a1
	move.l	$20(a1),a0
	move.l	_Warp3DBase,a6
	move.l	(a0),a0
	lea	-$24(a5),a1
	jsr	-$E4(a6)
L323
;		gfx->flush();
	move.l	a3,a1
	move.l	$20(a1),a0
	move.l	_Warp3DBase,a6
	move.l	(a0),a0
	jsr	-$1B0(a6)
;		gfx->unlock();
	move.l	a3,a1
	move.l	$20(a1),a0
	and.l	#-3,$A8(a0)
	move.l	_Warp3DBase,a6
	move.l	(a0),a0
	jsr	-$42(a6)
;		appDisplay->refresh();
	move.l	a3,a1
	move.l	$18(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$74(a1),d0
	move.l	d0,-(a7)
	move.l	$70(a1),a1
	jsr	(a1)
	addq.w	#4,a7
L324
;	printf("\nTesting Rasterizer::drawTriMesh2()\n\n");
	move.l	#L259,-(a7)
	jsr	_printf
	addq.w	#4,a7
;	testMesh2();
	move.l	a3,-(a7)
	jsr	testMesh2__GfxTestApp__T
	addq.w	#4,a7
;	appDisplay->setTitle("Tests completed");
	move.l	#L260,-(a7)
	move.l	a3,a1
	move.l	$18(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$6C(a1),d0
	move.l	d0,-(a7)
	move.l	$68(a1),a1
	jsr	(a1)
	addq.w	#$8,a7
;	Thread::sleep(1000);
	clr.w	-(a7)
	clr.w	-(a7)
	move.w	#1,-(a7)
	pea	$3E8.w
	jsr	sleep__Thread__Ujsss
	add.w	#$A,a7
;	return 0;
	moveq	#0,d0
	movem.l	(a7)+,d2-d4/a2/a3/a6
	unlk	a5
	rts

L246
	dc.b	$A,'Pixel format',$A,0
L247
	dc.b	$A,'States shade:',0
L258
	dc.b	$A,'Testing Rasterizer::drawTriMesh()',$A,$A,0
L259
	dc.b	$A,'Testing Rasterizer::drawTriMesh2()',$A,$A,0
L256
	dc.b	'%s',$A,0
L250
	dc.b	', cull:',0
L255
	dc.b	', tex:',0
L253
	dc.b	', zbuff:',0
L245
	dc.b	'Display Properties',$A,'Width: %d, Height: %d, Modulus: %d',$A,0
L260
	dc.b	'Tests completed',0
L248
	dc.b	'flat',0
L249
	dc.b	'gouraud',0
L257
	dc.b	'none',$A,0
L252
	dc.b	'off',0
L251
	dc.b	'on (CCW)',0
L254
	dc.b	'on (LESS/UPDATE)',0

	SECTION "doneApplication__AppBase__T:0",CODE

	CNOP	0,2

	XDEF	doneApplication__AppBase__T
doneApplication__AppBase__T
L326
	rts

	SECTION "open__DisplayWindow__TssEPCc:0",CODE

	CNOP	0,2

	XDEF	open__DisplayWindow__TssEPCc
open__DisplayWindow__TssEPCc
	move.l	d2,-(a7)
	movem.l	$10(a7),d2/a1
	move.w	$C(a7),d0
	move.w	$E(a7),d1
	move.l	$8(a7),a0
L327
	move.l	a1,-(a7)
	move.l	d2,-(a7)
	move.w	d1,-(a7)
	move.w	d0,-(a7)
	cmp.w	#0,a0
	beq.b	L329
L328
	addq.w	#4,a0
L329
	move.l	a0,-(a7)
	jsr	open__NativeWindow__TssEPCc
	add.w	#$10,a7
	move.l	(a7)+,d2
	rts

	SECTION "open__DisplayWindow__TP17DisplayPropertiesPCc:0",CODE

	CNOP	0,2

	XDEF	open__DisplayWindow__TP17DisplayPropertiesPCc
open__DisplayWindow__TP17DisplayPropertiesPCc
	move.l	a2,-(a7)
	movem.l	$8(a7),a0-a2
L330
	move.l	a2,-(a7)
	move.l	a1,-(a7)
	cmp.w	#0,a0
	beq.b	L332
L331
	addq.w	#4,a0
L332
	move.l	a0,-(a7)
	jsr	open__NativeWindow__TP17DisplayPropertiesPCc
	add.w	#$C,a7
	move.l	(a7)+,a2
	rts

	SECTION "reopen__DisplayWindow__T:0",CODE

	CNOP	0,2

	XDEF	reopen__DisplayWindow__T
reopen__DisplayWindow__T
	move.l	4(a7),a0
L333
	cmp.w	#0,a0
	beq.b	L335
L334
	addq.w	#4,a0
L335
	move.l	a0,-(a7)
	jsr	reopen__NativeWindow__T
	addq.w	#4,a7
	rts

	SECTION "close__DisplayWindow__T:0",CODE

	CNOP	0,2

	XDEF	close__DisplayWindow__T
close__DisplayWindow__T
	move.l	4(a7),a0
L336
	cmp.w	#0,a0
	beq.b	L338
L337
	addq.w	#4,a0
L338
	move.l	a0,-(a7)
	jsr	close__NativeWindow__T
	addq.w	#4,a7
	rts

	SECTION "waitSync__DisplayWindow__T:0",CODE

	CNOP	0,2

	XDEF	waitSync__DisplayWindow__T
waitSync__DisplayWindow__T
	move.l	4(a7),a0
L339
	cmp.w	#0,a0
	beq.b	L341
L340
	addq.w	#4,a0
L341
	move.l	a0,-(a7)
	jsr	waitForRefresh__DisplayNative__T
	addq.w	#4,a7
	rts

	SECTION "refresh__DisplayWindow__T:0",CODE

	CNOP	0,2

	XDEF	refresh__DisplayWindow__T
refresh__DisplayWindow__T
	move.l	4(a7),a0
L342
	cmp.w	#0,a0
	beq.b	L344
L343
	addq.w	#4,a0
L344
	move.l	a0,-(a7)
	jsr	refresh__NativeWindow__T
	addq.w	#4,a7
	rts

	SECTION "setTitle__DisplayWindow__TPCc:0",CODE

	CNOP	0,2

	XDEF	setTitle__DisplayWindow__TPCc
setTitle__DisplayWindow__TPCc
	movem.l	4(a7),a0/a1
L345
	cmp.w	#0,a0
	beq.b	L347
L346
	addq.w	#4,a0
L347
	clr.w	-(a7)
	move.l	a1,-(a7)
	move.l	a0,-(a7)
	jsr	setTitle__DisplayNative__TPCcs
	add.w	#$A,a7
	rts

	SECTION "getDrawSurface__DisplayWindow__T:0",CODE

	CNOP	0,2

	XDEF	getDrawSurface__DisplayWindow__T
getDrawSurface__DisplayWindow__T
	move.l	4(a7),a0
L348
	cmp.w	#0,a0
	beq.b	L350
L349
	addq.w	#4,a0
L350
	move.l	$54(a0),d0
	rts

	SECTION "_0dt__DisplayWindow__T:0",CODE

	CNOP	0,2

	XDEF	_0dt__DisplayWindow__T
_0dt__DisplayWindow__T
	move.l	a2,-(a7)
	move.l	$8(a7),a2
L351
	move.l	a2,a0
	cmp.w	#0,a0
	beq.b	L353
L352
	addq.w	#4,a0
L353
	move.l	a0,-(a7)
	jsr	close__NativeWindow__T
	addq.w	#4,a7
	pea	4(a2)
	jsr	_0dt__NativeWindow__T
	addq.w	#4,a7
	move.l	(a7)+,a2
	rts

	SECTION "_0virttab__13DisplayWindow__13DisplayWindow:0",CODE

	XDEF	_0virttab__13DisplayWindow__13DisplayWindow
_0virttab__13DisplayWindow__13DisplayWindow
	dc.l	$60,0
	dc.l	_0dt__DisplayWindow__T,0
	dc.l	getDrawSurface__DisplayWindow__T,0
	dc.l	setTitle__DisplayWindow__TPCc,0
	dc.l	refresh__DisplayWindow__T,0
	dc.l	waitSync__DisplayWindow__T,0
	dc.l	close__DisplayWindow__T,0
	dc.l	reopen__DisplayWindow__T,0
	dc.l	open__DisplayWindow__TP17DisplayPropertiesPCc,0
	dc.l	open__DisplayWindow__TssEPCc,0
	dc.l	$60,0
	dc.l	_0dt__DisplayWindow__T,0
	dc.l	getDrawSurface__DisplayWindow__T,0
	dc.l	setTitle__DisplayWindow__TPCc,0
	dc.l	refresh__DisplayWindow__T,0
	dc.l	waitSync__DisplayWindow__T,0
	dc.l	close__DisplayWindow__T,0
	dc.l	reopen__DisplayWindow__T,0
	dc.l	open__DisplayWindow__TP17DisplayPropertiesPCc,0
	dc.l	open__DisplayWindow__TssEPCc,0

	SECTION "_0virttab__10GfxTestApp__10GfxTestApp:0",CODE

	XDEF	_0virttab__10GfxTestApp__10GfxTestApp
_0virttab__10GfxTestApp__10GfxTestApp
	dc.l	$2E,0
	dc.l	_0dt__GfxTestApp__T,0
	dc.l	runApplication__GfxTestApp__T,0
	dc.l	doneApplication__AppBase__T,0
	dc.l	initApplication__GfxTestApp__T,0
	dc.l	$2E,0
	dc.l	_0dt__GfxTestApp__T,0
	dc.l	runApplication__GfxTestApp__T,0
	dc.l	initApplication__GfxTestApp__T,0

	END
