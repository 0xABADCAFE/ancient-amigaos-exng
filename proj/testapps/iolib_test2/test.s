
; Storm C Compiler
; Developer:eXtropia/eXtropiaNG/proj/NewIOTest/test.cpp
	mc68030
	mc68881
	XREF	_0dt__SimpleEventPlayer__T
	XREF	inputQueued__SimpleEventPlayer__T
	XREF	handleEvent__SimpleEventPlayer__T
	XREF	waitEvent__SimpleEventPlayer__T
	XREF	applyFilter__SimpleEventPlayer__T
	XREF	_0dt__SimpleEventRecorder__T
	XREF	open__SimpleEventRecorder__TPCc
	XREF	exitEvent__SimpleEventRecorder__TP15InputDispatcher
	XREF	mouseScroll__SimpleEventRecorder__TP15InputDispatcherss
	XREF	mouseDrag__SimpleEventRecorder__TP15InputDispatcherssssUj
	XREF	mouseMove__SimpleEventRecorder__TP15InputDispatcherssss
	XREF	mouseRelease__SimpleEventRecorder__TP15InputDispatcherUj
	XREF	mousePress__SimpleEventRecorder__TP15InputDispatcherUj
	XREF	keyReleasePrintable__SimpleEventRecorder__TP15InputDispatcherj
	XREF	keyPressPrintable__SimpleEventRecorder__TP15InputDispatcherj
	XREF	keyReleaseNonPrintable__SimpleEventRecorder__TP15InputDispatcherE
	XREF	keyPressNonPrintable__SimpleEventRecorder__TP15InputDispatcherE
	XREF	elapsed__Clock__T
	XREF	writeBytes__StreamOut__TPvUi
	XREF	close__StreamOut__T
	XREF	open__StreamOut__TPCcssUi
	XREF	rawReadBytes__StreamOut__TPvUij
	XREF	readBytes__StreamIn__TPvUi
	XREF	close__StreamIn__T
	XREF	open__StreamIn__TPCcsUi
	XREF	rawWriteBytes__StreamIn__TPvUij
	XREF	destroy__AsyncStreamBuffer__T
	XREF	sendPacket__AsyncStreamBuffer__TPv
	XREF	waitPacket__AsyncStreamBuffer__T
	XREF	close__InteractiveScreenBuffered__T
	XREF	reopen__InteractiveScreenBuffered__T
	XREF	open__InteractiveScreenBuffered__TP17DisplayPropertiesPCc
	XREF	open__InteractiveScreenBuffered__TssEPCc
	XREF	close__InteractiveScreen__T
	XREF	reopen__InteractiveScreen__T
	XREF	open__InteractiveScreen__TP17DisplayPropertiesPCc
	XREF	open__InteractiveScreen__TssEPCc
	XREF	close__InteractiveWindow__T
	XREF	reopen__InteractiveWindow__T
	XREF	open__InteractiveWindow__TP17DisplayPropertiesPCc
	XREF	open__InteractiveWindow__TssEPCc
	XREF	inputQueued__InteractiveDisplay__T
	XREF	handleEvent__InteractiveDisplay__T
	XREF	waitEvent__InteractiveDisplay__T
	XREF	discardQueue__InteractiveDisplay__T
	XREF	applyFilter__InteractiveDisplay__T
	XREF	_0dt__NativeInput__T
	XREF	_0ct__NativeInput__T
	XREF	_0ct__InputFocus__TUj
	XREF	inputQueued__InputDispatcher__T
	XREF	handleEvent__InputDispatcher__T
	XREF	waitEvent__InputDispatcher__T
	XREF	applyFilter__InputDispatcher__T
	XREF	discardQueue__InputDispatcher__T
	XREF	setIFilter__IFilter__TUj
	XREF	toggleIFilter__IFilter__TUj
	XREF	disableIFilter__IFilter__TUj
	XREF	enableIFilter__IFilter__TUj
	XREF	_0dt___LLBase__T
	XREF	_0ct___LLBase__T
	XREF	contains___LLBase__TPv
	XREF	repLast___LLBase__TPvPv
	XREF	repFirst___LLBase__TPvPv
	XREF	remLast___LLBase__TPv
	XREF	remFirst___LLBase__TPv
	XREF	remCurr___LLBase__T
	XREF	remFirst___LLBase__T
	XREF	remLast___LLBase__T
	XREF	insCurr___LLBase__TPv
	XREF	insFirst___LLBase__TPv
	XREF	insLast___LLBase__TPv
	XREF	rep___LLBase__r0jr1jr8Pvr9Pv
	XREF	cnt___LLBase__r0jr1jr8Pv
	XREF	rem___LLBase__r0jr1jr8Pv
	XREF	rem___LLBase__r0jr1j
	XREF	findBkwd___LLBase__TjPv
	XREF	findFwrd___LLBase__TjPv
	XREF	getValue__Key64__TPCc
	XREF	getValue__Key32__TPCc
	XREF	getDrawSurface__Display__T
	XREF	setTitle__Display__TPCc
	XREF	refresh__Display__T
	XREF	waitSync__Display__T
	XREF	close__Display__T
	XREF	reopen__Display__T
	XREF	open__Display__TP17DisplayPropertiesPCc
	XREF	open__Display__TssEPCc
	XREF	_0dt__NativeScreenDB__T
	XREF	_0ct__NativeScreenDB__T
	XREF	refresh__NativeScreenDB__T
	XREF	close__NativeScreenDB__T
	XREF	reopen__NativeScreenDB__T
	XREF	open__NativeScreenDB__TP17DisplayPropertiesPCc
	XREF	open__NativeScreenDB__TssEPCc
	XREF	_0dt__NativeScreen__T
	XREF	_0ct__NativeScreen__T
	XREF	close__NativeScreen__T
	XREF	reopen__NativeScreen__T
	XREF	open__NativeScreen__TP17DisplayPropertiesPCc
	XREF	open__NativeScreen__TssEPCc
	XREF	_0dt__NativeWindow__T
	XREF	_0ct__NativeWindow__T
	XREF	refresh__NativeWindow__T
	XREF	close__NativeWindow__T
	XREF	open__NativeWindow__TP17DisplayPropertiesPCc
	XREF	open__NativeWindow__TssEPCc
	XREF	reopen__NativeWindow__T
	XREF	_0ct__DisplayNative__T
	XREF	setTitle__DisplayNative__TPCcs
	XREF	waitForRefresh__DisplayNative__T
	XREF	destroy__Surface__T
	XREF	blitCopy__Surface__P07SurfacessP07Surfacessss
	XREF	create__Surface__TssP06BitMap
	XREF	init__Surface__T
	XREF	getHardwareFormat__Native2D__E
	XREF	done__GfxLib_
	XREF	init__GfxLib_
	XREF	findIndex__DisplayPropertiesProvider__ssEs
	XREF	getMode__DisplayPropertiesProvider__Ui
	XREF	destroy__ImageBuffer__T
	XREF	create__ImageBuffer__TssEP07Palettess
	XREF	runApplication__AppBase__T
	XREF	getSwitch__AppBase__PCcs
	XREF	getString__AppBase__PCcs
	XREF	dialogueBox__SystemLib__PCcPCcPCce
	XREF	_system
	XREF	op__delete__PvUi
	XREF	op__new__Ui
	XREF	_std__in
	XREF	_std__out
	XREF	_std__err
	XREF	_SysBase
	XREF	_IntuitionBase
	XREF	_debug__SystemLib
	XREF	_allocated__Mem
	XREF	_volatileBuff__Mem
	XREF	_totalSize__Mem
	XREF	_nextFree__Mem
	XREF	_count__Mem
	XREF	_maxAllocs__Mem
	XREF	_propTab__PixelDescriptor
	XREF	_modesAvail__DisplayPropertiesProvider
	XREF	_numModes__DisplayPropertiesProvider
	XREF	_GfxBase
	XREF	_CyberGfxBase
	XREF	_pixelType__Native2D
	XREF	_convTab__Native2D
	XREF	_modeID__DisplayNative
	XREF	_linkCache___LLBase
	XREF	_linkCacheSize___LLBase
	XREF	_linkCacheDelta___LLBase
	XREF	_linkCount___LLBase
	XREF	_nextFree___LLBase
	XREF	_openCount__NativeInput
	XREF	_nonPrintMap__NativeInput
	XREF	_DOSBase
	XREF	_TimerBase
	XREF	_clockFreq__MilliClock

	SECTION "getVolatile__Mem_:0",CODE

	rts

	SECTION "_redBalance__Colour:1",DATA

_redBalance__Colour
	dc.w	$4D

	SECTION "_greenBalance__Colour:1",DATA

_greenBalance__Colour
	dc.w	$96

	SECTION "_blueBalance__Colour:1",DATA

_blueBalance__Colour
	dc.w	$1C

	SECTION "op__plus__R04TimeR04Time:0",CODE


;Time operator+(Time& a, Time& b)
	XDEF	op__plus__R04TimeR04Time
op__plus__R04TimeR04Time
L93	EQU	-$10
	link	a5,#L93
L92
;	Time sum(a.totMillis() + b.totMillis());
	clr.l	-$8(a5)
	clr.l	-4(a5)
;	return sum;
	move.l	-$8(a5),d0
	move.l	-4(a5),d1
	move.l	$8(a5),a0
	move.l	d0,(a0)
	move.l	d1,4(a0)
	unlk	a5
	rts

	SECTION "op__minus__R04TimeR04Time:0",CODE


;Time operator-(Time& a, Time& b)
	XDEF	op__minus__R04TimeR04Time
op__minus__R04TimeR04Time
L95	EQU	-$10
	link	a5,#L95
L94
;	Time diff(a.totMillis() - b.totMillis());
	clr.l	-$8(a5)
	clr.l	-4(a5)
;	return diff;
	move.l	-$8(a5),d0
	move.l	-4(a5),d1
	move.l	$8(a5),a0
	move.l	d0,(a0)
	move.l	d1,4(a0)
	unlk	a5
	rts

	SECTION "_version:1",DATA

	XDEF	_version
_version
	dc.b	'$VER: test 0.1 K. Churchill (26.1.2004)',$A,0

	SECTION "init__AppBase_:0",CODE


;sint32 AppBase::init()
	XDEF	init__AppBase_
init__AppBase_
L97
;	return GfxLib::init();
	jsr	init__GfxLib_
	rts

	SECTION "done__AppBase_:0",CODE


;void AppBase::done()
	XDEF	done__AppBase_
done__AppBase_
L98
;	GfxLib::done();
	jsr	done__GfxLib_
	rts

	SECTION "createApplicationInstance__AppBase_:0",CODE


;AppBase* AppBase::createApplicationInstance()
	XDEF	createApplicationInstance__AppBase_
createApplicationInstance__AppBase_
	move.l	d2,-(a7)
L99
;	return new Application;
	pea	$3A.w
	jsr	op__new__Ui
	move.l	d0,d2
	addq.w	#4,a7
	move.l	d2,a0
	cmp.w	#0,a0
	beq.b	L101
L100
	move.l	d2,a1
	move.l	#_0virttab__11Application__11Application,$28(a1)
	move.l	d2,a1
	move.l	#_0virttab__07AppBase__11Application,(a1)
	move.l	d2,-(a7)
	jsr	_0ct__Application__T
	addq.w	#4,a7
L101
	move.l	d2,d0
	move.l	(a7)+,d2
	rts

	SECTION "destroyApplicationInstance__AppBase__P07AppBase:0",CODE


;void AppBase::destroyApplicationInstance(AppBase* app)
	XDEF	destroyApplicationInstance__AppBase__P07AppBase
destroyApplicationInstance__AppBase__P07AppBase
	move.l	a2,-(a7)
	move.l	$8(a7),a2
L102
;	delete app;
	cmp.w	#0,a2
	beq.b	L104
L103
	move.l	(a2),a0
	move.l	a2,d0
	add.l	$C(a0),d0
	move.l	d0,-(a7)
	move.l	$8(a0),a0
	jsr	(a0)
	addq.w	#4,a7
	move.l	(a2),a0
	move.l	(a0),-(a7)
	move.l	4(a0),d0
	add.l	a2,d0
	move.l	d0,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L104
	move.l	(a7)+,a2
	rts

	SECTION "_0ct__Application__T:0",CODE


;Application::Application() 
	XDEF	_0ct__Application__T
_0ct__Application__T
L139	EQU	-$30
	link	a5,#L139
	movem.l	d2/d3/a2/a3/a6,-(a7)
	move.l	$8(a5),a2
L114
	move.l	#$1E77F,-(a7)
	pea	4(a2)
	jsr	_0ct__InputFocus__TUj
	addq.w	#$8,a7
	move.l	a2,a1
	clr.l	$2C(a1)
	move.l	a2,a1
	clr.l	$30(a1)
	move.l	a2,a0
	move.w	#1,$34(a0)
	move.l	a2,a0
	move.w	#1,$36(a0)
	move.l	a2,a0
	clr.w	$38(a0)
;	if (getSwitch("fullscreen", false))
	clr.w	-(a7)
	move.l	#L105,-(a7)
	jsr	getSwitch__AppBase__PCcs
	addq.w	#6,a7
	tst.w	d0
	beq	L120
L115
;		appWindow = new InteractiveScreen(RESPONSES, "id_application");
	pea	$7E.w
	jsr	op__new__Ui
	move.l	d0,d2
	addq.w	#4,a7
	move.l	d2,a0
	cmp.w	#0,a0
	beq	L119
L116
	move.l	d2,a6
	move.l	#_0virttab__17InteractiveScreen__17InteractiveScreen,$1C(a6)
	lea	$26(a6),a0
	move.l	a0,$20(a6)
	clr.b	$24(a6)
	move.l	#_0virttab__07Display__17InteractiveScreen,(a6)
	move.l	a6,-$28(a5)
	move.l	-$28(a5),a3
	moveq	#4,d1
	add.l	d1,-$28(a5)
	move.l	#L106,-$20(a5)
	move.l	-$28(a5),a0
	move.l	#$1E77F,(a0)
	move.l	-$28(a5),a1
	pea	4(a1)
	jsr	_0ct___LLBase__T
	addq.w	#4,a7
	moveq	#$14,d0
	add.l	-$28(a5),d0
	move.l	d0,-$18(a5)
	move.l	-$20(a5),-(a7)
	move.l	-$18(a5),-(a7)
	jsr	getValue__Key32__TPCc
	addq.w	#$8,a7
	move.l	-$18(a5),a0
	move.l	d0,(a0)
	pea	$20(a3)
	jsr	_0ct__NativeInput__T
	addq.w	#4,a7
	move.l	a3,a0
	btst	#0,$24(a0)
	beq.b	L118
L117
	move.l	a3,a0
	move.l	$20(a0),-(a7)
	jsr	_0ct__DisplayNative__T
	addq.w	#4,a7
L118
	pea	$26(a6)
	jsr	_0ct__NativeScreen__T
	addq.w	#4,a7
L119
	move.l	a2,a1
	move.l	d2,$2C(a1)
	bra	L125
L120
;		appWindow = new InteractiveWindow(RESPONSES, "id_application");
	pea	$82.w
	jsr	op__new__Ui
	move.l	d0,d2
	addq.w	#4,a7
	move.l	d2,a0
	cmp.w	#0,a0
	beq	L124
L121
	move.l	d2,a6
	move.l	#_0virttab__17InteractiveWindow__17InteractiveWindow,$1C(a6)
	lea	$26(a6),a0
	move.l	a0,$20(a6)
	clr.b	$24(a6)
	move.l	#_0virttab__07Display__17InteractiveWindow,(a6)
	move.l	a6,-$2C(a5)
	move.l	-$2C(a5),a3
	moveq	#4,d1
	add.l	d1,-$2C(a5)
	move.l	#L106,-$24(a5)
	move.l	-$2C(a5),a0
	move.l	#$1E77F,(a0)
	move.l	-$2C(a5),a1
	pea	4(a1)
	jsr	_0ct___LLBase__T
	addq.w	#4,a7
	moveq	#$14,d0
	add.l	-$2C(a5),d0
	move.l	d0,-$1C(a5)
	move.l	-$24(a5),-(a7)
	move.l	-$1C(a5),-(a7)
	jsr	getValue__Key32__TPCc
	addq.w	#$8,a7
	move.l	-$1C(a5),a0
	move.l	d0,(a0)
	pea	$20(a3)
	jsr	_0ct__NativeInput__T
	addq.w	#4,a7
	move.l	a3,a0
	btst	#0,$24(a0)
	beq.b	L123
L122
	move.l	a3,a0
	move.l	$20(a0),-(a7)
	jsr	_0ct__DisplayNative__T
	addq.w	#4,a7
L123
	pea	$26(a6)
	jsr	_0ct__NativeWindow__T
	addq.w	#4,a7
L124
	move.l	a2,a1
	move.l	d2,$2C(a1)
L125
;	if (getSwitch("nosync", false))
	clr.w	-(a7)
	move.l	#L107,-(a7)
	jsr	getSwitch__AppBase__PCcs
	addq.w	#6,a7
	tst.w	d0
	beq.b	L127
L126
;		sync = false;
	move.l	a2,a0
	clr.w	$36(a0)
L127
;	if (getSwitch("norefresh", false))
	clr.w	-(a7)
	move.l	#L108,-(a7)
	jsr	getSwitch__AppBase__PCcs
	addq.w	#6,a7
	tst.w	d0
	beq.b	L129
L128
;		refresh = false;
	move.l	a2,a0
	clr.w	$34(a0)
L129
;	const char* eventFileName = 0;
;	if (eventFileName = getString("record", false))
	clr.w	-(a7)
	move.l	#L109,-(a7)
	jsr	getString__AppBase__PCcs
	addq.w	#6,a7
	move.l	d0,-4(a5)
	tst.l	-4(a5)
	beq	L138
L130
;		if (!(recorder = new SimpleEventRecorder))
	pea	$3C.w
	jsr	op__new__Ui
	move.l	d0,a3
	addq.w	#4,a7
	move.l	a3,a0
	cmp.w	#0,a0
	beq.b	L132
L131
	move.l	a3,a1
	move.l	#_0virttab__19SimpleEventRecorder__19SimpleEventRecorder,$24(a1)
	move.l	#-1,-(a7)
	move.l	a3,-(a7)
	jsr	_0ct__InputFocus__TUj
	addq.w	#$8,a7
	move.l	a3,a1
	clr.l	$28(a1)
	lea	$2C(a3),a0
	clr.l	$8(a0)
	clr.l	$C(a0)
	move.l	a0,-$30(a5)
	move.l	_TimerBase,a6
	jsr	-$42(a6)
	move.l	-$30(a5),a0
	clr.l	$8(a0)
	clr.l	$C(a0)
L132
	move.l	a2,a1
	move.l	a3,$30(a1)
	cmp.w	#0,a3
	bne.b	L134
L133
;			SystemLib::dialogueBox("Warning", "Proceed", "Unabl
	move.l	#L110,-(a7)
	move.l	#L111,-(a7)
	move.l	#L112,-(a7)
	jsr	dialogueBox__SystemLib__PCcPCcPCce
	add.w	#$C,a7
	bra.b	L138
L134
;		else if (recorder->open(eventFileName)!=OK)
	move.l	-4(a5),-(a7)
	move.l	a2,a1
	move.l	$30(a1),-(a7)
	jsr	open__SimpleEventRecorder__TPCc
	addq.w	#$8,a7
	tst.l	d0
	beq.b	L138
L135
;			SystemLib::dialogueBox("Warning", "Proceed", "Unabl
	move.l	#L113,-(a7)
	move.l	#L111,-(a7)
	move.l	#L112,-(a7)
	jsr	dialogueBox__SystemLib__PCcPCcPCce
	add.w	#$C,a7
;			delete recorder;
	move.l	a2,a0
	move.l	$30(a0),a6
	cmp.w	#0,a6
	beq.b	L137
L136
	move.l	$24(a6),a0
	move.l	a6,d0
	add.l	$6C(a0),d0
	move.l	d0,-(a7)
	move.l	$68(a0),a0
	jsr	(a0)
	addq.w	#4,a7
	move.l	$24(a6),a0
	move.l	$60(a0),-(a7)
	move.l	$64(a0),d0
	add.l	a6,d0
	move.l	d0,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L137
;			recorder = 0;
	move.l	a2,a1
	clr.l	$30(a1)
L138
	movem.l	(a7)+,d2/d3/a2/a3/a6
	unlk	a5
	rts

L111
	dc.b	'Proceed',0
L113
	dc.b	'Unable to create event log file',$A,''%s'',0
L110
	dc.b	'Unable to create event recorder',0
L112
	dc.b	'Warning',0
L105
	dc.b	'fullscreen',0
L106
	dc.b	'id_application',0
L108
	dc.b	'norefresh',0
L107
	dc.b	'nosync',0
L109
	dc.b	'record',0

	SECTION "_0dt__Application__T:0",CODE


;Application::~Application()
	XDEF	_0dt__Application__T
_0dt__Application__T
	movem.l	a2/a3,-(a7)
	move.l	$C(a7),a3
L140
;	if (recorder)		
	move.l	a3,a1
	tst.l	$30(a1)
	beq.b	L143
L141
;	if (recorder)		delete recorder;
	move.l	a3,a0
	move.l	$30(a0),a2
	cmp.w	#0,a2
	beq.b	L143
L142
	move.l	$24(a2),a0
	move.l	a2,d0
	add.l	$6C(a0),d0
	move.l	d0,-(a7)
	move.l	$68(a0),a0
	jsr	(a0)
	addq.w	#4,a7
	move.l	$24(a2),a0
	move.l	$60(a0),-(a7)
	move.l	$64(a0),d0
	add.l	a2,d0
	move.l	d0,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L143
;	if (appWindow)	
	move.l	a3,a1
	tst.l	$2C(a1)
	beq.b	L146
L144
;	if (appWindow)	delete appWindow;
	move.l	a3,a0
	move.l	$2C(a0),a2
	cmp.w	#0,a2
	beq.b	L146
L145
	move.l	$1C(a2),a0
	move.l	a2,d0
	add.l	$44(a0),d0
	move.l	d0,-(a7)
	move.l	$40(a0),a0
	jsr	(a0)
	addq.w	#4,a7
	move.l	$1C(a2),a0
	move.l	$38(a0),-(a7)
	move.l	$3C(a0),d0
	add.l	a2,d0
	move.l	d0,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L146
	movem.l	(a7)+,a2/a3
	rts

	SECTION "keyPressNonPrintable__Application__TP15InputDispatcherE:0",CODE


;void Application::keyPressNonPrintable(InputDispatcher* src, Key::Ct
	XDEF	keyPressNonPrintable__Application__TP15InputDispatcherE
keyPressNonPrintable__Application__TP15InputDispatcherE
	move.l	$C(a7),d0
	move.l	4(a7),a0
L147
;	switch (code)
	cmp.l	#$B,d0
	beq.b	L149
	bgt.b	L153
	cmp.l	#5,d0
	beq.b	L148
	bra.b	L151
L153
	cmp.l	#$C,d0
	beq.b	L150
	bra.b	L151
;		
L148
;		case Key::ESC:	quit 		= true;
	move.w	#1,$38(a0)
;			
	bra.b	L152
L149
;		case Key::F1:		sync 		= !sync;
	tst.w	$36(a0)
	seq	d0
	and.l	#1,d0
	move.w	d0,$36(a0)
;		
	bra.b	L152
L150
;		case Key::F2:		refresh	= !refresh;
	tst.w	$34(a0)
	seq	d0
	and.l	#1,d0
	move.w	d0,$34(a0)
;	
L151
;		default: 
L152
	rts

	SECTION "initApplication__Application__T:0",CODE


;sint32 Application::initApplication()
	XDEF	initApplication__Application__T
initApplication__Application__T
L181	EQU	-$8
	link	a5,#L181
	movem.l	a2/a3/a6,-(a7)
	move.l	$8(a5),a2
L159
;	if (!appWindow)
	tst.l	$2C(a2)
	bne.b	L161
L160
;		SystemLib::dialogueBox("Error", "Exit", "Failed to cr
	move.l	#L154,-(a7)
	move.l	#L155,-(a7)
	move.l	#L156,-(a7)
	jsr	dialogueBox__SystemLib__PCcPCcPCce
	add.w	#$C,a7
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,a2/a3/a6
	unlk	a5
	rts
L161
;	if (appWindow->open(400, 300, Pixel::BPP8, "Input Test [Esc to qui
	move.l	#L157,-(a7)
	pea	$8.w
	move.w	#$12C,-(a7)
	move.w	#$190,-(a7)
	move.l	$2C(a2),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$4C(a1),d0
	move.l	d0,-(a7)
	move.l	$48(a1),a1
	jsr	(a1)
	add.w	#$10,a7
	tst.l	d0
	beq.b	L163
L162
;		SystemLib::dialogueBox("Error", "Exit", "Failed to op
	move.l	#L158,-(a7)
	move.l	#L155,-(a7)
	move.l	#L156,-(a7)
	jsr	dialogueBox__SystemLib__PCcPCcPCce
	add.w	#$C,a7
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,a2/a3/a6
	unlk	a5
	rts
L163
;	appWindow->addFocus(this);
	move.l	a2,a6
	move.l	a6,a0
	cmp.w	#0,a0
	beq.b	L165
L164
	moveq	#4,d0
	add.l	a6,d0
	move.l	d0,a6
L165
	move.l	$2C(a2),-$8(a5)
	move.l	-$8(a5),a0
	cmp.w	#0,a0
	beq.b	L167
L166
	moveq	#4,d0
	add.l	d0,-$8(a5)
L167
	cmp.w	#0,a6
	beq.b	L170
L168
	move.l	-$8(a5),a3
	pea	(a6)
	pea	4(a3)
	jsr	contains___LLBase__TPv
	addq.w	#$8,a7
	tst.w	d0
	bne.b	L170
L169
	move.l	-$8(a5),a3
	pea	(a6)
	pea	4(a3)
	jsr	insLast___LLBase__TPv
	addq.w	#$8,a7
L170
L171
;	if (recorder)
	tst.l	$30(a2)
	beq.b	L180
L172
;		recorder->setFocusFilter(getFocusFilter());
	move.l	a2,a0
	cmp.w	#0,a0
	beq.b	L174
L173
	addq.w	#4,a0
L174
	move.l	(a0),d0
	move.l	d0,-(a7)
	move.l	$30(a2),-(a7)
	jsr	setIFilter__IFilter__TUj
	addq.w	#$8,a7
;		appWindow->addFocus(recorder);
	move.l	$30(a2),a3
	move.l	$2C(a2),a2
	cmp.w	#0,a2
	beq.b	L176
L175
	addq.w	#4,a2
L176
	cmp.w	#0,a3
	beq.b	L179
L177
	pea	(a3)
	pea	4(a2)
	jsr	contains___LLBase__TPv
	addq.w	#$8,a7
	tst.w	d0
	bne.b	L179
L178
	pea	(a3)
	pea	4(a2)
	jsr	insLast___LLBase__TPv
	addq.w	#$8,a7
L179
L180
;	return OK;
	moveq	#0,d0
	movem.l	(a7)+,a2/a3/a6
	unlk	a5
	rts

L156
	dc.b	'Error',0
L155
	dc.b	'Exit',0
L154
	dc.b	'Failed to create application window',0
L158
	dc.b	'Failed to open application window',0
L157
	dc.b	'Input Test [Esc to quit]',0

	SECTION "runApplication__Application__T:0",CODE


;sint32 Application::runApplication()
	XDEF	runApplication__Application__T
runApplication__Application__T
L198	EQU	-$28
	link	a5,#L198
	movem.l	d2-d5/a2/a3/a6,-(a7)
	fmovem.x fp2,-(a7)
	move.l	$8(a5),a2
L185
;	Clock		timer;
	lea	-$10(a5),a0
	clr.l	$8(a0)
	clr.l	$C(a0)
	move.l	a0,a3
	move.l	_TimerBase,a6
	jsr	-$42(a6)
	move.l	a3,a0
	clr.l	$8(a0)
	clr.l	$C(a0)
;	sint32	events = 0;
	moveq	#0,d4
;	sint32	frames = 0;
	moveq	#0,d3
;	sint32	peak = 0;
	moveq	#0,d5
;	while (!quit)
	bra.b	L196
L186
;		sint32 eventsThisFrame = 0;
	moveq	#0,d2
;		while (appWindow->handleEvent())
	bra.b	L188
L187
;			eventsThisFrame++;
	addq.l	#1,d2
L188
	move.l	a2,a1
	move.l	$2C(a1),a0
	move.l	$1C(a0),a1
	move.l	a0,d0
	add.l	$54(a1),d0
	move.l	d0,-(a7)
	move.l	$50(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	tst.w	d0
	bne.b	L187
L189
;		events += eventsThisFrame;
	add.l	d2,d4
;		if (eventsThisFrame > peak)
	cmp.l	d5,d2
	ble.b	L191
L190
;			peak = eventsThisFrame;
	move.l	d2,d5
L191
;		if (sync)
	move.l	a2,a0
	tst.w	$36(a0)
	beq.b	L193
L192
;			appWindow->waitSync();
	move.l	a2,a1
	move.l	$2C(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$2C(a1),d0
	move.l	d0,-(a7)
	move.l	$28(a1),a1
	jsr	(a1)
	addq.w	#4,a7
L193
;		if (refresh)
	move.l	a2,a0
	tst.w	$34(a0)
	beq.b	L195
L194
;			appWindow->refresh();
	move.l	a2,a1
	move.l	$2C(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$24(a1),d0
	move.l	d0,-(a7)
	move.l	$20(a1),a1
	jsr	(a1)
	addq.w	#4,a7
L195
;		frames++;
	addq.l	#1,d3
L196
	move.l	a2,a0
	tst.w	$38(a0)
	beq.b	L186
L197
;	appWindow->close();
	move.l	a2,a1
	move.l	$2C(a1),a0
	move.l	(a0),a1
	move.l	a0,d0
	add.l	$34(a1),d0
	move.l	d0,-(a7)
	move.l	$30(a1),a1
	jsr	(a1)
	addq.w	#4,a7
;	Time& totTime = timer.elapsed();
	pea	-$10(a5)
	jsr	elapsed__Clock__T
	addq.w	#4,a7
	move.l	d0,a0
;	float32 fps = (float32)(frames*1000)/(float32)((sint32)totTime.tot
	move.l	d3,d0
	muls.l	#$3E8,d0
	fmove.l	d0,fp1
	move.l	(a0),d0
	move.l	4(a0),d1
	fmove.l	d1,fp0
	fdiv.x	fp0,fp1
;	float32 average = (float32)events/(float32)frames;
	fmove.l	d4,fp0
	fmove.l	d3,fp2
	fdiv.x	fp2,fp0
;	SystemLib::dialogueBox("Info", "Ok", "Frames:%d, Events
	fmove.d	fp1,-(a7)
	move.l	d5,-(a7)
	fmove.d	fp0,-(a7)
	move.l	d4,-(a7)
	move.l	d3,-(a7)
	move.l	#L182,-(a7)
	move.l	#L183,-(a7)
	move.l	#L184,-(a7)
	jsr	dialogueBox__SystemLib__PCcPCcPCce
	add.w	#$28,a7
;	return 0;
	moveq	#0,d0
	fmovem.x (a7)+,fp2
	movem.l	(a7)+,d2-d5/a2/a3/a6
	unlk	a5
	rts

L182
	dc.b	'Frames:%d, Events:%d',$A,'Average:%.4f, Peak %d',$A,'FPS : %.4f',0
L184
	dc.b	'Info',0
L183
	dc.b	'Ok',0

	SECTION "doneApplication__AppBase__T:0",CODE

	CNOP	0,2

	XDEF	doneApplication__AppBase__T
doneApplication__AppBase__T
L199
	rts

	SECTION "keyReleaseNonPrintable__InputFocus__TP15InputDispatcherE:0",CODE

	CNOP	0,2

	XDEF	keyReleaseNonPrintable__InputFocus__TP15InputDispatcherE
keyReleaseNonPrintable__InputFocus__TP15InputDispatcherE
L200
	rts

	SECTION "keyPressPrintable__InputFocus__TP15InputDispatcherj:0",CODE

	CNOP	0,2

	XDEF	keyPressPrintable__InputFocus__TP15InputDispatcherj
keyPressPrintable__InputFocus__TP15InputDispatcherj
L201
	rts

	SECTION "keyReleasePrintable__InputFocus__TP15InputDispatcherj:0",CODE

	CNOP	0,2

	XDEF	keyReleasePrintable__InputFocus__TP15InputDispatcherj
keyReleasePrintable__InputFocus__TP15InputDispatcherj
L202
	rts

	SECTION "mousePress__InputFocus__TP15InputDispatcherUj:0",CODE

	CNOP	0,2

	XDEF	mousePress__InputFocus__TP15InputDispatcherUj
mousePress__InputFocus__TP15InputDispatcherUj
L203
	rts

	SECTION "mouseRelease__InputFocus__TP15InputDispatcherUj:0",CODE

	CNOP	0,2

	XDEF	mouseRelease__InputFocus__TP15InputDispatcherUj
mouseRelease__InputFocus__TP15InputDispatcherUj
L204
	rts

	SECTION "mouseMove__InputFocus__TP15InputDispatcherssss:0",CODE

	CNOP	0,2

	XDEF	mouseMove__InputFocus__TP15InputDispatcherssss
mouseMove__InputFocus__TP15InputDispatcherssss
L205
	rts

	SECTION "mouseDrag__InputFocus__TP15InputDispatcherssssUj:0",CODE

	CNOP	0,2

	XDEF	mouseDrag__InputFocus__TP15InputDispatcherssssUj
mouseDrag__InputFocus__TP15InputDispatcherssssUj
L206
	rts

	SECTION "mouseScroll__InputFocus__TP15InputDispatcherss:0",CODE

	CNOP	0,2

	XDEF	mouseScroll__InputFocus__TP15InputDispatcherss
mouseScroll__InputFocus__TP15InputDispatcherss
L207
	rts

	SECTION "exitEvent__InputFocus__TP15InputDispatcher:0",CODE

	CNOP	0,2

	XDEF	exitEvent__InputFocus__TP15InputDispatcher
exitEvent__InputFocus__TP15InputDispatcher
L208
	rts

	SECTION "waitSync__InteractiveWindow__T:0",CODE

	CNOP	0,2

	XDEF	waitSync__InteractiveWindow__T
waitSync__InteractiveWindow__T
	move.l	4(a7),a0
L209
	cmp.w	#0,a0
	beq.b	L211
L210
	add.w	#$26,a0
L211
	move.l	a0,-(a7)
	jsr	waitForRefresh__DisplayNative__T
	addq.w	#4,a7
	rts

	SECTION "refresh__InteractiveWindow__T:0",CODE

	CNOP	0,2

	XDEF	refresh__InteractiveWindow__T
refresh__InteractiveWindow__T
	move.l	4(a7),a0
L212
	cmp.w	#0,a0
	beq.b	L214
L213
	add.w	#$26,a0
L214
	move.l	a0,-(a7)
	jsr	refresh__NativeWindow__T
	addq.w	#4,a7
	rts

	SECTION "setTitle__InteractiveWindow__TPCc:0",CODE

	CNOP	0,2

	XDEF	setTitle__InteractiveWindow__TPCc
setTitle__InteractiveWindow__TPCc
	movem.l	4(a7),a0/a1
L215
	cmp.w	#0,a0
	beq.b	L217
L216
	add.w	#$26,a0
L217
	clr.w	-(a7)
	move.l	a1,-(a7)
	move.l	a0,-(a7)
	jsr	setTitle__DisplayNative__TPCcs
	add.w	#$A,a7
	rts

	SECTION "getDrawSurface__InteractiveWindow__T:0",CODE

	CNOP	0,2

	XDEF	getDrawSurface__InteractiveWindow__T
getDrawSurface__InteractiveWindow__T
	move.l	4(a7),a0
L218
	cmp.w	#0,a0
	beq.b	L220
L219
	add.w	#$26,a0
L220
	move.l	$54(a0),d0
	rts

	SECTION "_0dt__InteractiveWindow__T:0",CODE

	CNOP	0,2

	XDEF	_0dt__InteractiveWindow__T
_0dt__InteractiveWindow__T
	move.l	a2,-(a7)
	move.l	$8(a7),a2
L221
	move.l	a2,-(a7)
	jsr	close__InteractiveWindow__T
	addq.w	#4,a7
	pea	$26(a2)
	jsr	_0dt__NativeWindow__T
	addq.w	#4,a7
	move.l	a2,-(a7)
	jsr	discardQueue__InteractiveDisplay__T
	addq.w	#4,a7
	btst	#0,$24(a2)
L222
L223
	pea	$20(a2)
	jsr	_0dt__NativeInput__T
	addq.w	#4,a7
	lea	4(a2),a0
	pea	4(a0)
	jsr	_0dt__t07RefList_10InputFocus___T
	addq.w	#4,a7
	move.l	(a7)+,a2
	rts

	SECTION "waitSync__InteractiveScreen__T:0",CODE

	CNOP	0,2

	XDEF	waitSync__InteractiveScreen__T
waitSync__InteractiveScreen__T
	move.l	4(a7),a0
L224
	cmp.w	#0,a0
	beq.b	L226
L225
	add.w	#$26,a0
L226
	move.l	a0,-(a7)
	jsr	waitForRefresh__DisplayNative__T
	addq.w	#4,a7
	rts

	SECTION "refresh__InteractiveScreen__T:0",CODE

	CNOP	0,2

	XDEF	refresh__InteractiveScreen__T
refresh__InteractiveScreen__T
L227
L228
L229
	rts

	SECTION "setTitle__InteractiveScreen__TPCc:0",CODE

	CNOP	0,2

	XDEF	setTitle__InteractiveScreen__TPCc
setTitle__InteractiveScreen__TPCc
	movem.l	4(a7),a0/a1
L230
	cmp.w	#0,a0
	beq.b	L232
L231
	add.w	#$26,a0
L232
	move.w	#1,-(a7)
	move.l	a1,-(a7)
	move.l	a0,-(a7)
	jsr	setTitle__DisplayNative__TPCcs
	add.w	#$A,a7
	rts

	SECTION "getDrawSurface__InteractiveScreen__T:0",CODE

	CNOP	0,2

	XDEF	getDrawSurface__InteractiveScreen__T
getDrawSurface__InteractiveScreen__T
	move.l	4(a7),a0
L233
	cmp.w	#0,a0
	beq.b	L235
L234
	add.w	#$26,a0
L235
	move.l	$54(a0),d0
	rts

	SECTION "_0dt__InteractiveScreen__T:0",CODE

	CNOP	0,2

	XDEF	_0dt__InteractiveScreen__T
_0dt__InteractiveScreen__T
	move.l	a2,-(a7)
	move.l	$8(a7),a2
L236
	move.l	a2,-(a7)
	jsr	close__InteractiveScreen__T
	addq.w	#4,a7
	pea	$26(a2)
	jsr	_0dt__NativeScreen__T
	addq.w	#4,a7
	move.l	a2,-(a7)
	jsr	discardQueue__InteractiveDisplay__T
	addq.w	#4,a7
	btst	#0,$24(a2)
L237
L238
	pea	$20(a2)
	jsr	_0dt__NativeInput__T
	addq.w	#4,a7
	lea	4(a2),a0
	pea	4(a0)
	jsr	_0dt__t07RefList_10InputFocus___T
	addq.w	#4,a7
	move.l	(a7)+,a2
	rts

	SECTION "_0dt__t07RefList_10InputFocus___T:0",CODE

	CNOP	0,2

_0dt__t07RefList_10InputFocus___T
	move.l	4(a7),a0
L239
	move.l	a0,-(a7)
	jsr	_0dt___LLBase__T
	addq.w	#4,a7
	rts

	SECTION "_0virttab__17InteractiveWindow__17InteractiveWindow:0",CODE

	XDEF	_0virttab__17InteractiveWindow__17InteractiveWindow
_0virttab__17InteractiveWindow__17InteractiveWindow
	dc.l	$82,-4
	dc.l	_0dt__InteractiveWindow__T,-4
	dc.l	inputQueued__InteractiveDisplay__T,-4
	dc.l	handleEvent__InteractiveDisplay__T,-4
	dc.l	waitEvent__InteractiveDisplay__T,-4
	dc.l	applyFilter__InteractiveDisplay__T,-4
	dc.l	discardQueue__InteractiveDisplay__T,-4
	dc.l	$82,0
	dc.l	_0dt__InteractiveWindow__T,0
	dc.l	inputQueued__InteractiveDisplay__T,0
	dc.l	handleEvent__InteractiveDisplay__T,0
	dc.l	waitEvent__InteractiveDisplay__T,0
	dc.l	discardQueue__InteractiveDisplay__T,0
	dc.l	applyFilter__InteractiveDisplay__T,0
	dc.l	$82,0
	dc.l	_0dt__InteractiveWindow__T,0
	dc.l	getDrawSurface__InteractiveWindow__T,0
	dc.l	setTitle__InteractiveWindow__TPCc,0
	dc.l	refresh__InteractiveWindow__T,0
	dc.l	waitSync__InteractiveWindow__T,0
	dc.l	close__InteractiveWindow__T,0
	dc.l	reopen__InteractiveWindow__T,0
	dc.l	open__InteractiveWindow__TP17DisplayPropertiesPCc,0
	dc.l	open__InteractiveWindow__TssEPCc,0

	SECTION "_0virttab__07Display__17InteractiveWindow:0",CODE

	XDEF	_0virttab__07Display__17InteractiveWindow
_0virttab__07Display__17InteractiveWindow
	dc.l	$82,0
	dc.l	_0dt__InteractiveWindow__T,0
	dc.l	getDrawSurface__InteractiveWindow__T,0
	dc.l	setTitle__InteractiveWindow__TPCc,0
	dc.l	refresh__InteractiveWindow__T,0
	dc.l	waitSync__InteractiveWindow__T,0
	dc.l	close__InteractiveWindow__T,0
	dc.l	reopen__InteractiveWindow__T,0
	dc.l	open__InteractiveWindow__TP17DisplayPropertiesPCc,0
	dc.l	open__InteractiveWindow__TssEPCc,0

	SECTION "_0virttab__17InteractiveScreen__17InteractiveScreen:0",CODE

	XDEF	_0virttab__17InteractiveScreen__17InteractiveScreen
_0virttab__17InteractiveScreen__17InteractiveScreen
	dc.l	$7E,-4
	dc.l	_0dt__InteractiveScreen__T,-4
	dc.l	inputQueued__InteractiveDisplay__T,-4
	dc.l	handleEvent__InteractiveDisplay__T,-4
	dc.l	waitEvent__InteractiveDisplay__T,-4
	dc.l	applyFilter__InteractiveDisplay__T,-4
	dc.l	discardQueue__InteractiveDisplay__T,-4
	dc.l	$7E,0
	dc.l	_0dt__InteractiveScreen__T,0
	dc.l	inputQueued__InteractiveDisplay__T,0
	dc.l	handleEvent__InteractiveDisplay__T,0
	dc.l	waitEvent__InteractiveDisplay__T,0
	dc.l	discardQueue__InteractiveDisplay__T,0
	dc.l	applyFilter__InteractiveDisplay__T,0
	dc.l	$7E,0
	dc.l	_0dt__InteractiveScreen__T,0
	dc.l	getDrawSurface__InteractiveScreen__T,0
	dc.l	setTitle__InteractiveScreen__TPCc,0
	dc.l	refresh__InteractiveScreen__T,0
	dc.l	waitSync__InteractiveScreen__T,0
	dc.l	close__InteractiveScreen__T,0
	dc.l	reopen__InteractiveScreen__T,0
	dc.l	open__InteractiveScreen__TP17DisplayPropertiesPCc,0
	dc.l	open__InteractiveScreen__TssEPCc,0

	SECTION "_0virttab__07Display__17InteractiveScreen:0",CODE

	XDEF	_0virttab__07Display__17InteractiveScreen
_0virttab__07Display__17InteractiveScreen
	dc.l	$7E,0
	dc.l	_0dt__InteractiveScreen__T,0
	dc.l	getDrawSurface__InteractiveScreen__T,0
	dc.l	setTitle__InteractiveScreen__TPCc,0
	dc.l	refresh__InteractiveScreen__T,0
	dc.l	waitSync__InteractiveScreen__T,0
	dc.l	close__InteractiveScreen__T,0
	dc.l	reopen__InteractiveScreen__T,0
	dc.l	open__InteractiveScreen__TP17DisplayPropertiesPCc,0
	dc.l	open__InteractiveScreen__TssEPCc,0

	SECTION "_0virttab__19SimpleEventRecorder__19SimpleEventRecorder:0",CODE

	XDEF	_0virttab__19SimpleEventRecorder__19SimpleEventRecorder
_0virttab__19SimpleEventRecorder__19SimpleEventRecorder
	dc.l	$3C,0
	dc.l	_0dt__SimpleEventRecorder__T,0
	dc.l	exitEvent__SimpleEventRecorder__TP15InputDispatcher,0
	dc.l	mouseScroll__SimpleEventRecorder__TP15InputDispatcherss,0
	dc.l	mouseDrag__SimpleEventRecorder__TP15InputDispatcherssssUj,0
	dc.l	mouseMove__SimpleEventRecorder__TP15InputDispatcherssss,0
	dc.l	mouseRelease__SimpleEventRecorder__TP15InputDispatcherUj,0
	dc.l	mousePress__SimpleEventRecorder__TP15InputDispatcherUj,0
	dc.l	keyReleasePrintable__SimpleEventRecorder__TP15InputDispatcherj,0
	dc.l	keyPressPrintable__SimpleEventRecorder__TP15InputDispatcherj,0
	dc.l	keyReleaseNonPrintable__SimpleEventRecorder__TP15InputDispatcherE,0
	dc.l	keyPressNonPrintable__SimpleEventRecorder__TP15InputDispatcherE,0
	dc.l	$3C,0
	dc.l	_0dt__SimpleEventRecorder__T,0
	dc.l	exitEvent__SimpleEventRecorder__TP15InputDispatcher,0
	dc.l	mouseScroll__SimpleEventRecorder__TP15InputDispatcherss,0
	dc.l	mouseDrag__SimpleEventRecorder__TP15InputDispatcherssssUj,0
	dc.l	mouseMove__SimpleEventRecorder__TP15InputDispatcherssss,0
	dc.l	mouseRelease__SimpleEventRecorder__TP15InputDispatcherUj,0
	dc.l	mousePress__SimpleEventRecorder__TP15InputDispatcherUj,0
	dc.l	keyReleasePrintable__SimpleEventRecorder__TP15InputDispatcherj,0
	dc.l	keyPressPrintable__SimpleEventRecorder__TP15InputDispatcherj,0
	dc.l	keyReleaseNonPrintable__SimpleEventRecorder__TP15InputDispatcherE,0
	dc.l	keyPressNonPrintable__SimpleEventRecorder__TP15InputDispatcherE,0

	SECTION "_0virttab__11Application__11Application:0",CODE

	XDEF	_0virttab__11Application__11Application
_0virttab__11Application__11Application
	dc.l	$3A,-4
	dc.l	_0dt__Application__T,-4
	dc.l	exitEvent__InputFocus__TP15InputDispatcher,0
	dc.l	mouseScroll__InputFocus__TP15InputDispatcherss,0
	dc.l	mouseDrag__InputFocus__TP15InputDispatcherssssUj,0
	dc.l	mouseMove__InputFocus__TP15InputDispatcherssss,0
	dc.l	mouseRelease__InputFocus__TP15InputDispatcherUj,0
	dc.l	mousePress__InputFocus__TP15InputDispatcherUj,0
	dc.l	keyReleasePrintable__InputFocus__TP15InputDispatcherj,0
	dc.l	keyPressPrintable__InputFocus__TP15InputDispatcherj,0
	dc.l	keyReleaseNonPrintable__InputFocus__TP15InputDispatcherE,0
	dc.l	keyPressNonPrintable__Application__TP15InputDispatcherE,-4
	dc.l	$3A,0
	dc.l	_0dt__Application__T,0
	dc.l	keyPressNonPrintable__Application__TP15InputDispatcherE,0
	dc.l	runApplication__Application__T,0
	dc.l	initApplication__Application__T,0

	SECTION "_0virttab__07AppBase__11Application:0",CODE

	XDEF	_0virttab__07AppBase__11Application
_0virttab__07AppBase__11Application
	dc.l	$3A,0
	dc.l	_0dt__Application__T,0
	dc.l	runApplication__Application__T,0
	dc.l	doneApplication__AppBase__T,0
	dc.l	initApplication__Application__T,0

	END
