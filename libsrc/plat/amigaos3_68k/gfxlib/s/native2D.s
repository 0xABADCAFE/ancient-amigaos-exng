
; Storm C Compiler
; exng:libsrc/plat/amigaos3_68k/gfxlib/native2D.cpp
	mc68030
	mc68881
	XREF	getDrawSurface__Display__T
	XREF	setTitle__Display__TPCc
	XREF	refresh__Display__Tssss
	XREF	refresh__Display__T
	XREF	waitSync__Display__T
	XREF	close__Display__T
	XREF	reopen__Display__T
	XREF	open__Display__TP17DisplayPropertiesPCc
	XREF	open__Display__TssEPCc
	XREF	_0dt__NativeScreenDB__T
	XREF	_0ct__NativeScreenDB__T
	XREF	refresh__NativeScreenDB__T
	XREF	close__NativeScreenDB__T
	XREF	reopen__NativeScreenDB__T
	XREF	open__NativeScreenDB__TP17DisplayPropertiesPCc
	XREF	open__NativeScreenDB__TssEPCc
	XREF	_0dt__NativeScreen__T
	XREF	_0ct__NativeScreen__T
	XREF	close__NativeScreen__T
	XREF	reopen__NativeScreen__T
	XREF	open__NativeScreen__TP17DisplayPropertiesPCc
	XREF	open__NativeScreen__TssEPCc
	XREF	_0dt__NativeWindow__T
	XREF	_0ct__NativeWindow__T
	XREF	refresh__NativeWindow__Tssss
	XREF	refresh__NativeWindow__T
	XREF	close__NativeWindow__T
	XREF	open__NativeWindow__TP17DisplayPropertiesPCc
	XREF	open__NativeWindow__TssEPCc
	XREF	reopen__NativeWindow__T
	XREF	setDisplayTitle__DisplayNative__TPCcs
	XREF	waitForRefresh__DisplayNative__T
	XREF	blitCopy__Surface__P07SurfacessP07Surfacessss
	XREF	destroy__Surface__T
	XREF	init__Surface__T
	XREF	rotate32LETo32BE__Pix32__PvPvPUjssss
	XREF	rotate32BETo32LE__Pix32__PvPvPUjssss
	XREF	rotate32LETo32LE__Pix32__PvPvPUjssss
	XREF	rotate32BETo32BE__Pix32__PvPvPUjssss
	XREF	copy32XETo32YE__Pix32__PvPvPUjssss
	XREF	copy32XETo32XE__Pix32__PvPvPUjssss
	XREF	rotate32LETo24XGY__Pix32__PvPvPUjssss
	XREF	rotate32BETo24XGY__Pix32__PvPvPUjssss
	XREF	copy32LETo24XGY__Pix32__PvPvPUjssss
	XREF	copy32BETo24XGY__Pix32__PvPvPUjssss
	XREF	rotate32LETo16BE__Pix32__PvPvPUjssss
	XREF	rotate32BETo16LE__Pix32__PvPvPUjssss
	XREF	rotate32LETo16LE__Pix32__PvPvPUjssss
	XREF	rotate32BETo16BE__Pix32__PvPvPUjssss
	XREF	copy32LETo16BE__Pix32__PvPvPUjssss
	XREF	copy32BETo16LE__Pix32__PvPvPUjssss
	XREF	copy32LETo16LE__Pix32__PvPvPUjssss
	XREF	copy32BETo16BE__Pix32__PvPvPUjssss
	XREF	rotate32LETo15BE__Pix32__PvPvPUjssss
	XREF	rotate32BETo15LE__Pix32__PvPvPUjssss
	XREF	rotate32LETo15LE__Pix32__PvPvPUjssss
	XREF	rotate32BETo15BE__Pix32__PvPvPUjssss
	XREF	copy32LETo15BE__Pix32__PvPvPUjssss
	XREF	copy32BETo15LE__Pix32__PvPvPUjssss
	XREF	copy32LETo15LE__Pix32__PvPvPUjssss
	XREF	copy32BETo15BE__Pix32__PvPvPUjssss
	XREF	rotate24XGYTo32LE__Pix24__PvPvPUjssss
	XREF	rotate24XGYTo32BE__Pix24__PvPvPUjssss
	XREF	copy24XGYTo32LE__Pix24__PvPvPUjssss
	XREF	copy24XGYTo32BE__Pix24__PvPvPUjssss
	XREF	rotate24To24__Pix24__PvPvPUjssss
	XREF	copy24To24__Pix24__PvPvPUjssss
	XREF	rotate24XGYTo16LE__Pix24__PvPvPUjssss
	XREF	rotate24XGYTo16BE__Pix24__PvPvPUjssss
	XREF	copy24XGYTo16LE__Pix24__PvPvPUjssss
	XREF	copy24XGYTo16BE__Pix24__PvPvPUjssss
	XREF	rotate24XGYTo15LE__Pix24__PvPvPUjssss
	XREF	rotate24XGYTo15BE__Pix24__PvPvPUjssss
	XREF	copy24XGYTo15LE__Pix24__PvPvPUjssss
	XREF	copy24XGYTo15BE__Pix24__PvPvPUjssss
	XREF	rotate16LETo32BE__Pix16__PvPvPUjssss
	XREF	rotate16BETo32LE__Pix16__PvPvPUjssss
	XREF	rotate16LETo32LE__Pix16__PvPvPUjssss
	XREF	rotate16BETo32BE__Pix16__PvPvPUjssss
	XREF	copy16LETo32BE__Pix16__PvPvPUjssss
	XREF	copy16BETo32LE__Pix16__PvPvPUjssss
	XREF	copy16LETo32LE__Pix16__PvPvPUjssss
	XREF	copy16BETo32BE__Pix16__PvPvPUjssss
	XREF	rotate16LETo24XGY__Pix16__PvPvPUjssss
	XREF	rotate16BETo24XGY__Pix16__PvPvPUjssss
	XREF	copy16LETo24XGY__Pix16__PvPvPUjssss
	XREF	copy16BETo24XGY__Pix16__PvPvPUjssss
	XREF	rotate16LETo16BE__Pix16__PvPvPUjssss
	XREF	rotate16BETo16LE__Pix16__PvPvPUjssss
	XREF	rotate16LETo16LE__Pix16__PvPvPUjssss
	XREF	rotate16BETo16BE__Pix16__PvPvPUjssss
	XREF	copy16XETo16YE__Pix16__PvPvPUjssss
	XREF	copy16XETo16XE__Pix16__PvPvPUjssss
	XREF	rotate16LETo15BE__Pix16__PvPvPUjssss
	XREF	rotate16BETo15LE__Pix16__PvPvPUjssss
	XREF	rotate16LETo15LE__Pix16__PvPvPUjssss
	XREF	rotate16BETo15BE__Pix16__PvPvPUjssss
	XREF	copy16LETo15BE__Pix16__PvPvPUjssss
	XREF	copy16BETo15LE__Pix16__PvPvPUjssss
	XREF	copy16LETo15LE__Pix16__PvPvPUjssss
	XREF	copy16BETo15BE__Pix16__PvPvPUjssss
	XREF	rotate15LETo32BE__Pix15__PvPvPUjssss
	XREF	rotate15BETo32LE__Pix15__PvPvPUjssss
	XREF	rotate15LETo32LE__Pix15__PvPvPUjssss
	XREF	rotate15BETo32BE__Pix15__PvPvPUjssss
	XREF	copy15LETo32BE__Pix15__PvPvPUjssss
	XREF	copy15BETo32LE__Pix15__PvPvPUjssss
	XREF	copy15LETo32LE__Pix15__PvPvPUjssss
	XREF	copy15BETo32BE__Pix15__PvPvPUjssss
	XREF	rotate15LETo24XGY__Pix15__PvPvPUjssss
	XREF	rotate15BETo24XGY__Pix15__PvPvPUjssss
	XREF	copy15LETo24XGY__Pix15__PvPvPUjssss
	XREF	copy15BETo24XGY__Pix15__PvPvPUjssss
	XREF	rotate15LETo16BE__Pix15__PvPvPUjssss
	XREF	rotate15BETo16LE__Pix15__PvPvPUjssss
	XREF	rotate15LETo16LE__Pix15__PvPvPUjssss
	XREF	rotate15BETo16BE__Pix15__PvPvPUjssss
	XREF	copy15LETo16BE__Pix15__PvPvPUjssss
	XREF	copy15BETo16LE__Pix15__PvPvPUjssss
	XREF	copy15LETo16LE__Pix15__PvPvPUjssss
	XREF	copy15BETo16BE__Pix15__PvPvPUjssss
	XREF	rotate15LETo15BE__Pix15__PvPvPUjssss
	XREF	rotate15BETo15LE__Pix15__PvPvPUjssss
	XREF	rotate15LETo15LE__Pix15__PvPvPUjssss
	XREF	rotate15BETo15BE__Pix15__PvPvPUjssss
	XREF	copy15XETo15YE__Pix15__PvPvPUjssss
	XREF	copy15XETo15XE__Pix15__PvPvPUjssss
	XREF	convABGR32LE__Pix8__PvPvPUjssss
	XREF	convARGB32LE__Pix8__PvPvPUjssss
	XREF	convABGR32BE__Pix8__PvPvPUjssss
	XREF	convARGB32BE__Pix8__PvPvPUjssss
	XREF	convBGR24__Pix8__PvPvPUjssss
	XREF	convRGB24__Pix8__PvPvPUjssss
	XREF	convBGR16LE__Pix8__PvPvPUjssss
	XREF	convRGB16LE__Pix8__PvPvPUjssss
	XREF	convBGR16BE__Pix8__PvPvPUjssss
	XREF	convRGB16BE__Pix8__PvPvPUjssss
	XREF	convBGR15LE__Pix8__PvPvPUjssss
	XREF	convRGB15LE__Pix8__PvPvPUjssss
	XREF	convBGR15BE__Pix8__PvPvPUjssss
	XREF	convRGB15BE__Pix8__PvPvPUjssss
	XREF	setName__DisplayPropertiesProvider__UiPCc
	XREF	setFormat__DisplayPropertiesProvider__UiEE
	XREF	setPropertyFlags__DisplayPropertiesProvider__UiUs
	XREF	setDimension__DisplayPropertiesProvider__Uiss
	XREF	setTiming__DisplayPropertiesProvider__UiUjUj
	XREF	setModeIndex__DisplayPropertiesProvider__UiUj
	XREF	findIndex__DisplayPropertiesProvider__ssEs
	XREF	getMode__DisplayPropertiesProvider__Ui
	XREF	freeModeDatabase__DisplayPropertiesProvider_
	XREF	createModeDatabase__DisplayPropertiesProvider__Ui
	XREF	destroy__ImageBuffer__T
	XREF	runApplication__AppBase__T
	XREF	copy__Mem__r8Pvr9Pvr0Ui
	XREF	printDebug__SystemLib__PCci
	XREF	_system
	XREF	op__delete__PvUi
	XREF	op__new__Ui
	XREF	_std__in
	XREF	_std__out
	XREF	_std__err
	XREF	_SysBase
	XREF	_IntuitionBase
	XREF	_debug__SystemLib
	XREF	_allocated__Mem
	XREF	_volatileBuff__Mem
	XREF	_totalSize__Mem
	XREF	_nextFree__Mem
	XREF	_count__Mem
	XREF	_maxAllocs__Mem
	XREF	_propTab__PixelDescriptor
	XREF	_modesAvail__DisplayPropertiesProvider
	XREF	_numModes__DisplayPropertiesProvider
	XREF	_GfxBase
	XREF	_modeID__DisplayNative

	SECTION "getVolatile__Mem_:0",CODE

	rts

	SECTION "_redBalance__Colour:1",DATA

_redBalance__Colour
	dc.w	$4D

	SECTION "_greenBalance__Colour:1",DATA

_greenBalance__Colour
	dc.w	$96

	SECTION "_blueBalance__Colour:1",DATA

_blueBalance__Colour
	dc.w	$1C

	SECTION "_CyberGfxBase:1",DATA

	XDEF	_CyberGfxBase
_CyberGfxBase
	dc.l	0

	SECTION "_GfxBase:1",DATA

	XDEF	_GfxBase
_GfxBase
	dc.l	0

	SECTION "init__GfxLib_:0",CODE


;sint32 GfxLib::init()
	XDEF	init__GfxLib_
init__GfxLib_
	move.l	a6,-(a7)
L45
;	if (!(::GfxBase = (struct GfxBase*)OpenLibrary("graphics.library",
	move.l	_SysBase,a6
	moveq	#$27,d0
	move.l	#L41,a1
	jsr	-$228(a6)
	move.l	d0,_GfxBase
	tst.l	_GfxBase
	bne.b	L47
L46
;fxLib::init() Una
	pea	2.w
	move.l	#L42,-(a7)
	jsr	printDebug__SystemLib__PCci
	addq.w	#$8,a7
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	move.l	(a7)+,a6
	rts
L47
;	CyberGfxBase = OpenLibrary("cybergraphics.library", 41);
	move.l	_SysBase,a6
	moveq	#$29,d0
	move.l	#L43,a1
	jsr	-$228(a6)
	move.l	d0,_CyberGfxBase
;	if (!CyberGfxBase)
	tst.l	_CyberGfxBase
	bne.b	L49
L48
;::init() Unable t
	pea	2.w
	move.l	#L44,-(a7)
	jsr	printDebug__SystemLib__PCci
	addq.w	#$8,a7
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	move.l	(a7)+,a6
	rts
L49
;	return buildDisplayDataBase();
	jsr	buildDisplayDataBase__GfxLib_
	move.l	(a7)+,a6
	rts

L44
	dc.b	'GfxLib::init() Unable to open cybergraphics.library, v41',0
L42
	dc.b	'GfxLib::init() Unable to open graphics.library, v39',0
L43
	dc.b	'cybergraphics.library',0
L41
	dc.b	'graphics.library',0

	SECTION "done__GfxLib_:0",CODE


;void GfxLib::done()
	XDEF	done__GfxLib_
done__GfxLib_
	move.l	a6,-(a7)
L50
;	freeDisplayDataBase();
	jsr	freeDisplayDataBase__GfxLib_
;	if (CyberGfxBase)
	tst.l	_CyberGfxBase
	beq.b	L52
L51
;		CloseLibrary(CyberGfxBase);
	move.l	_CyberGfxBase,a1
	move.l	_SysBase,a6
	jsr	-$19E(a6)
;		CyberGfxBase = 0;
	clr.l	_CyberGfxBase
L52
;	if (::GfxBase)
	tst.l	_GfxBase
	beq.b	L54
L53
;		CloseLibrary((Library*)::GfxBase);
	move.l	_GfxBase,a1
	move.l	_SysBase,a6
	jsr	-$19E(a6)
;		::GfxBase = 0;
	clr.l	_GfxBase
L54
	move.l	(a7)+,a6
	rts

	SECTION "buildDisplayDataBase__GfxLib_:0",CODE


;sint32 GfxLib::buildDisplayDataBase()
	XDEF	buildDisplayDataBase__GfxLib_
buildDisplayDataBase__GfxLib_
L74	EQU	-$84
	link	a5,#L74
	movem.l	d2/d3/a2/a3/a6,-(a7)
L58
;	List* cyberModeList = AllocCModeListTagList(0);
	move.l	_CyberGfxBase,a6
	sub.l	a1,a1
	jsr	-$48(a6)
	move.l	d0,-$64(a5)
;	if (!cyberModeList)
	tst.l	-$64(a5)
	bne.b	L60
L59
;ataBase() Unable 
	pea	2.w
	move.l	#L55,-(a7)
	jsr	printDebug__SystemLib__PCci
	addq.w	#$8,a7
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,d2/d3/a2/a3/a6
	unlk	a5
	rts
L60
;	size_t numModes = 0;
	moveq	#0,d2
;	for (node = cyberModeList->lh_Head;
	move.l	-$64(a5),a0
	move.l	(a0),a3
	bra.b	L62
L61
;		numModes++;
	addq.l	#1,d2
	move.l	a3,a0
	move.l	(a0),a3
L62
	move.l	a3,a1
	tst.l	(a1)
	bne.b	L61
L63
;	numModes++;
	addq.l	#1,d2
;	if (!createModeDatabase(numModes))
	move.l	d2,-(a7)
	jsr	createModeDatabase__DisplayPropertiesProvider__Ui
	addq.w	#4,a7
	tst.l	d0
	bne.b	L65
L64
;uildDisplayDataBa
	pea	2.w
	move.l	#L56,-(a7)
	jsr	printDebug__SystemLib__PCci
	addq.w	#$8,a7
;		FreeCModeList(cyberModeList);
	move.l	_CyberGfxBase,a6
	move.l	-$64(a5),a0
	jsr	-$4E(a6)
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,d2/d3/a2/a3/a6
	unlk	a5
	rts
L65
;	if (!(DisplayNative::modeID = new uint32[numModes]))
	move.l	d2,d0
	moveq	#2,d2
	asl.l	d2,d0
	move.l	d0,-(a7)
	jsr	op__new__Ui
	addq.w	#4,a7
	move.l	d0,_modeID__DisplayNative
	tst.l	_modeID__DisplayNative
	bne.b	L67
L66
;ayDataBase() Unab
	pea	2.w
	move.l	#L57,-(a7)
	jsr	printDebug__SystemLib__PCci
	addq.w	#$8,a7
;		FreeCModeList(cyberModeList);
	move.l	_CyberGfxBase,a6
	move.l	-$64(a5),a0
	jsr	-$4E(a6)
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,d2/d3/a2/a3/a6
	unlk	a5
	rts
L67
;		DisplayNative::modeID[0] = 0;
	move.l	_modeID__DisplayNative,a0
	clr.l	(a0)
;		setPropertyFlags(0, D_PRP::WINDOWMODE);
	move.w	#$AAC3,-(a7)
	clr.l	-(a7)
	jsr	setPropertyFlags__DisplayPropertiesProvider__UiUs
	addq.w	#6,a7
;		setTiming(0, 10000, 20000);
	pea	$4E20.w
	pea	$2710.w
	clr.l	-(a7)
	jsr	setTiming__DisplayPropertiesProvider__UiUjUj
	add.w	#$C,a7
;		getWindowedLimits();
	jsr	getWindowedLimits__GfxLib_
;	sint32 i = 1;
	moveq	#1,d3
;	for (node = cyberModeList->lh_Head;
	move.l	-$64(a5),a0
	move.l	(a0),a3
	bra	L72
L68
;		CyberModeNode* p = (CyberModeNode*)node;
	move.l	a3,a2
;		DisplayNative::modeID[i] = p->DisplayID;
	move.l	a2,a0
	move.l	$2E(a0),d0
	move.l	_modeID__DisplayNative,a1
	move.l	d0,0(a1,d3.l*4)
;		setModeIndex(i, i);
	move.l	d3,-(a7)
	move.l	d3,-(a7)
	jsr	setModeIndex__DisplayPropertiesProvider__UiUj
	addq.w	#$8,a7
;		if (GetDisplayInfoData(0, (uint8*)&monInfo, sizeof(MonitorInfo),
	move.l	a2,a0
	move.l	$2E(a0),d2
	move.l	_GfxBase,a6
	moveq	#$60,d0
	move.l	#$80002000,d1
	sub.l	a0,a0
	lea	-$60(a5),a1
	jsr	-$2F4(a6)
	cmp.l	#$26,d0
	blo.b	L70
L69
;			uint32 hNano	= (280*(uint32)monInfo.TotalColorClocks);
	moveq	#0,d0
	move.w	-$3A(a5),d0
	move.l	d0,d2
	mulu.l	#$118,d2
;			uint32 vMicro = (280*(uint32)monInfo.TotalColorClocks*(uint32)
	moveq	#0,d0
	move.w	-$3A(a5),d0
	mulu.l	#$118,d0
	moveq	#0,d1
	move.w	-$3C(a5),d1
	mulu.l	d1,d0
	divul.l	#$3E8,d0
;			setTiming(i, hNano, vMicro);
	move.l	d0,-(a7)
	move.l	d2,-(a7)
	move.l	d3,-(a7)
	jsr	setTiming__DisplayPropertiesProvider__UiUjUj
	add.w	#$C,a7
	bra.b	L71
L70
;			setTiming(i, 1, 20000);
	pea	$4E20.w
	pea	1.w
	move.l	d3,-(a7)
	jsr	setTiming__DisplayPropertiesProvider__UiUjUj
	add.w	#$C,a7
L71
;		setDimension(i, p->Width, p->Height);
	move.l	a2,a0
	move.w	$34(a0),-(a7)
	move.l	a2,a0
	move.w	$32(a0),-(a7)
	move.l	d3,-(a7)
	jsr	setDimension__DisplayPropertiesProvider__Uiss
	addq.w	#$8,a7
;		setPropertyFlags(i, 0xFFFF);
	move.w	#$FFFF,-(a7)
	move.l	d3,-(a7)
	jsr	setPropertyFlags__DisplayPropertiesProvider__UiUs
	addq.w	#6,a7
;		setFormat(i, (P_F)GetCyberIDAttr(CYBRIDATTR_PIXFMT, p->DisplayID)
	move.l	a2,a0
	moveq	#0,d0
	move.w	$36(a0),d0
	move.l	d0,-(a7)
	move.l	a2,a0
	move.l	_CyberGfxBase,a6
	move.l	#$80000001,d0
	move.l	$2E(a0),d1
	jsr	-$66(a6)
	move.l	d0,-(a7)
	move.l	d3,-(a7)
	jsr	setFormat__DisplayPropertiesProvider__UiEE
	add.w	#$C,a7
;		setName(i, p->ModeText);
	pea	$E(a2)
	move.l	d3,-(a7)
	jsr	setName__DisplayPropertiesProvider__UiPCc
	addq.w	#$8,a7
	move.l	a3,a0
	move.l	(a0),a3
	addq.l	#1,d3
L72
	move.l	a3,a1
	tst.l	(a1)
	bne	L68
L73
;	FreeCModeList(cyberModeList);
	move.l	_CyberGfxBase,a6
	move.l	-$64(a5),a0
	jsr	-$4E(a6)
;	return OK;
	moveq	#0,d0
	movem.l	(a7)+,d2/d3/a2/a3/a6
	unlk	a5
	rts

L56
	dc.b	'GfxLib::buildDisplayDataBase() Unable to build display list',0
L57
	dc.b	'GfxLib::buildDisplayDataBase() Unable to build display mode ID t'
	dc.b	'able',0
L55
	dc.b	'GfxLib::buildDisplayDataBase() Unable to get cybergraphics displ'
	dc.b	'ay list',0

	SECTION "freeDisplayDataBase__GfxLib_:0",CODE


;void GfxLib::freeDisplayDataBase()
	XDEF	freeDisplayDataBase__GfxLib_
freeDisplayDataBase__GfxLib_
L75
;	freeModeDatabase();
	jsr	freeModeDatabase__DisplayPropertiesProvider_
;	delete DisplayNative::modeID;
	move.l	_modeID__DisplayNative,a0
	move.l	_modeID__DisplayNative,a1
	cmp.w	#0,a1
	beq.b	L77
L76
	pea	4.w
	move.l	a0,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L77
;	DisplayNative::modeID = 0;
	clr.l	_modeID__DisplayNative
	rts

	SECTION "getWindowedLimits__GfxLib_:0",CODE


;sint32 GfxLib::getWindowedLimits()
	XDEF	getWindowedLimits__GfxLib_
getWindowedLimits__GfxLib_
	movem.l	d2-d5/a2/a6,-(a7)
L78
;	if (!DisplayNative::modeID)
	tst.l	_modeID__DisplayNative
	bne.b	L80
L79
;		return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,d2-d5/a2/a6
	rts
L80
;	if (s = LockPubScreen(0))
	move.l	_IntuitionBase,a6
	sub.l	a0,a0
	jsr	-$1FE(a6)
	move.l	d0,a2
	cmp.w	#0,a2
	beq	L84
L81
;		if (GetCyberMapAttr(s->RastPort.BitMap, CYBRMATTR_ISCYBERGFX))
	move.l	_CyberGfxBase,a6
	move.l	#$80000008,d0
	move.l	$58(a2),a0
	jsr	-$60(a6)
	tst.l	d0
	beq	L83
L82
;			sint16 w = GetCyberMapAttr(s->RastPort.BitMap, CYBRMATTR_WIDTH)
	move.l	_CyberGfxBase,a6
	move.l	#$80000005,d0
	move.l	$58(a2),a0
	jsr	-$60(a6)
	move.w	d0,d5
;			sint16 h = GetCyberMapAttr(s->RastPort.BitMap, CYBRMATTR_HEIGH
	move.l	_CyberGfxBase,a6
	move.l	#$80000006,d0
	move.l	$58(a2),a0
	jsr	-$60(a6)
	move.w	d0,d4
;			P_D d = (P_D)GetCyberMapAttr(s->RastPort.BitMap, CYBRMATTR_DEP
	move.l	_CyberGfxBase,a6
	move.l	#$80000007,d0
	move.l	$58(a2),a0
	jsr	-$60(a6)
	move.l	d0,d3
;			P_F f = (P_F)GetCyberMapAttr(s->RastPort.BitMap, CYBRMATTR_PIX
	move.l	_CyberGfxBase,a6
	move.l	#$80000004,d0
	move.l	$58(a2),a0
	jsr	-$60(a6)
	move.l	d0,d2
;			setDimension(0, w, h);
	move.w	d4,-(a7)
	move.w	d5,-(a7)
	clr.l	-(a7)
	jsr	setDimension__DisplayPropertiesProvider__Uiss
	addq.w	#$8,a7
;			setFormat(0, f, d);
	move.l	d3,-(a7)
	move.l	d2,-(a7)
	clr.l	-(a7)
	jsr	setFormat__DisplayPropertiesProvider__UiEE
	add.w	#$C,a7
;			UnlockPubScreen(0, s);
	move.l	_IntuitionBase,a6
	sub.l	a0,a0
	move.l	a2,a1
	jsr	-$204(a6)
;			return OK;
	moveq	#0,d0
	movem.l	(a7)+,d2-d5/a2/a6
	rts
L83
;		return ERR_RSC_INVALID;
	move.l	#-$3050008,d0
	movem.l	(a7)+,d2-d5/a2/a6
	rts
L84
;	return ERR_RSC_UNAVAILABLE;
	move.l	#-$3050005,d0
	movem.l	(a7)+,d2-d5/a2/a6
	rts

	SECTION "_pixelType__Native2D:1",DATA

	XDEF	_pixelType__Native2D
_pixelType__Native2D
	dc.l	0,1,2,3,4,5,6,7,$8,$9,$A
	dc.l	$B,$B,$C,$D

	SECTION "getHardwareFormat__Native2D__E:0",CODE


;P_F Native2D::getHardwareFormat(P_T t)
	XDEF	getHardwareFormat__Native2D__E
getHardwareFormat__Native2D__E
	move.l	4(a7),d0
L86
;	return map[t];
	move.l	#_map__getHardwareFormat__Native2D__E,a1
	move.l	0(a1,d0.l*4),d0
	rts

	SECTION "getHardwareFormat__Native2D__E:1",DATA

_map__getHardwareFormat__Native2D__E
	dc.l	0,0,0,1,5,$9,$B

	SECTION "convertPixels__Native2D__PvPvEEssssP07Palette:0",CODE


;sint32 Native2D::convertPixels(PXCONV, Palette* sPal)
	XDEF	convertPixels__Native2D__PvPvEEssssP07Palette
convertPixels__Native2D__PvPvEEssssP07Palette
	movem.l	d2-d5/a2,-(a7)
	movem.l	$20(a7),d0/d1
	move.w	$28(a7),d2
	move.w	$2A(a7),d3
	move.w	$2C(a7),d4
	move.w	$2E(a7),d5
	move.l	$30(a7),a0
	move.l	$18(a7),a1
	move.l	$1C(a7),a2
L87
;	convTab[sf][df](d, s, (uint32*)(sPal->getTable()), w, h, ds, ss);
	move.w	d5,-(a7)
	move.w	d4,-(a7)
	move.w	d3,-(a7)
	move.w	d2,-(a7)
	move.l	a0,-(a7)
	move.l	a2,-(a7)
	move.l	a1,-(a7)
	muls.l	#$3C,d1
	move.l	#_convTab__Native2D,a1
	lea	0(a1,d1.l),a0
	move.l	0(a0,d0.l*4),a0
	jsr	(a0)
	add.w	#$14,a7
;	return OK;
	moveq	#0,d0
	movem.l	(a7)+,d2-d5/a2
	rts

	SECTION "none__Native2D__PvPvPUjssss:0",CODE


;void Native2D::none(PXARG)
	XDEF	none__Native2D__PvPvPUjssss
none__Native2D__PvPvPUjssss
L88
	rts

	SECTION "copy8__Native2D__PvPvPUjssss:0",CODE


;void Native2D::copy8(PXARG)
	XDEF	copy8__Native2D__PvPvPUjssss
copy8__Native2D__PvPvPUjssss
	movem.l	d2-d5/a2/a3,-(a7)
	move.w	$2A(a7),d2
	move.w	$2E(a7),d3
	move.w	$2C(a7),d4
	move.w	$28(a7),d5
	move.l	$20(a7),a2
	move.l	$1C(a7),a3
L89
;	if (dst==src)
	move.l	a3,a0
	cmp.l	a2,a0
	bne.b	L91
L90
;		return;
	movem.l	(a7)+,d2-d5/a2/a3
	rts
L91
;	h++;
	addq.w	#1,d2
;	while(--h)
	bra.b	L93
L92
;		Mem::copy(dst, src, w);
	move.w	d5,d0
	ext.l	d0
	move.l	a3,a0
	move.l	a2,a1
	jsr	copy__Mem__r8Pvr9Pvr0Ui
;		((uint16*)dst)+=dSpan;
	move.w	d4,d0
	ext.l	d0
	moveq	#1,d1
	asl.l	d1,d0
	add.l	a3,d0
	move.l	d0,a3
;		((uint16*)src)+=sSpan;
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asl.l	d1,d0
	add.l	d0,a2
L93
	subq.w	#1,d2
	tst.w	d2
	bne.b	L92
L94
	movem.l	(a7)+,d2-d5/a2/a3
	rts

	SECTION "_convTab__Native2D:1",DATA

	XDEF	_convTab__Native2D
_convTab__Native2D
	dc.l	copy8__Native2D__PvPvPUjssss,convRGB15BE__Pix8__PvPvPUjssss,convBGR15BE__Pix8__PvPvPUjssss,convRGB15LE__Pix8__PvPvPUjssss,convBGR15LE__Pix8__PvPvPUjssss,convRGB16BE__Pix8__PvPvPUjssss,convBGR16BE__Pix8__PvPvPUjssss,convRGB16LE__Pix8__PvPvPUjssss,convBGR16LE__Pix8__PvPvPUjssss,convRGB24__Pix8__PvPvPUjssss,convBGR24__Pix8__PvPvPUjssss
	dc.l	convARGB32BE__Pix8__PvPvPUjssss,convABGR32BE__Pix8__PvPvPUjssss,convARGB32LE__Pix8__PvPvPUjssss,convABGR32LE__Pix8__PvPvPUjssss,none__Native2D__PvPvPUjssss,copy15XETo15XE__Pix15__PvPvPUjssss,rotate15BETo15BE__Pix15__PvPvPUjssss,copy15XETo15YE__Pix15__PvPvPUjssss,rotate15BETo15LE__Pix15__PvPvPUjssss,copy15BETo16BE__Pix15__PvPvPUjssss,rotate15BETo16BE__Pix15__PvPvPUjssss
	dc.l	copy15BETo16LE__Pix15__PvPvPUjssss,rotate15BETo16LE__Pix15__PvPvPUjssss,copy15BETo24XGY__Pix15__PvPvPUjssss,rotate15BETo24XGY__Pix15__PvPvPUjssss,copy15BETo32BE__Pix15__PvPvPUjssss,rotate15BETo32BE__Pix15__PvPvPUjssss,copy15BETo32LE__Pix15__PvPvPUjssss,rotate15BETo32LE__Pix15__PvPvPUjssss,none__Native2D__PvPvPUjssss,rotate15BETo15BE__Pix15__PvPvPUjssss,copy15XETo15XE__Pix15__PvPvPUjssss
	dc.l	rotate15BETo15LE__Pix15__PvPvPUjssss,copy15XETo15YE__Pix15__PvPvPUjssss,rotate15BETo16BE__Pix15__PvPvPUjssss,copy15BETo16BE__Pix15__PvPvPUjssss,rotate15BETo16LE__Pix15__PvPvPUjssss,copy15BETo16LE__Pix15__PvPvPUjssss,rotate15BETo24XGY__Pix15__PvPvPUjssss,copy15BETo24XGY__Pix15__PvPvPUjssss,rotate15BETo32BE__Pix15__PvPvPUjssss,copy15BETo32BE__Pix15__PvPvPUjssss,rotate15BETo32LE__Pix15__PvPvPUjssss
	dc.l	copy15BETo32LE__Pix15__PvPvPUjssss,none__Native2D__PvPvPUjssss,copy15XETo15YE__Pix15__PvPvPUjssss,rotate15LETo15BE__Pix15__PvPvPUjssss,copy15XETo15XE__Pix15__PvPvPUjssss,rotate15LETo15LE__Pix15__PvPvPUjssss,copy15LETo16BE__Pix15__PvPvPUjssss,rotate15LETo16BE__Pix15__PvPvPUjssss,copy15LETo16LE__Pix15__PvPvPUjssss,rotate15LETo16LE__Pix15__PvPvPUjssss,copy15LETo24XGY__Pix15__PvPvPUjssss
	dc.l	rotate15LETo24XGY__Pix15__PvPvPUjssss,copy15LETo32BE__Pix15__PvPvPUjssss,rotate15LETo32BE__Pix15__PvPvPUjssss,copy15LETo32LE__Pix15__PvPvPUjssss,rotate15LETo32LE__Pix15__PvPvPUjssss,none__Native2D__PvPvPUjssss,rotate15LETo15BE__Pix15__PvPvPUjssss,copy15XETo15YE__Pix15__PvPvPUjssss,rotate15LETo15LE__Pix15__PvPvPUjssss,copy15XETo15XE__Pix15__PvPvPUjssss,rotate15LETo16BE__Pix15__PvPvPUjssss
	dc.l	copy15LETo16BE__Pix15__PvPvPUjssss,rotate15LETo16LE__Pix15__PvPvPUjssss,copy15LETo16LE__Pix15__PvPvPUjssss,rotate15LETo24XGY__Pix15__PvPvPUjssss,copy15LETo24XGY__Pix15__PvPvPUjssss,rotate15LETo32BE__Pix15__PvPvPUjssss,copy15LETo32BE__Pix15__PvPvPUjssss,rotate15LETo32LE__Pix15__PvPvPUjssss,copy15LETo32LE__Pix15__PvPvPUjssss,none__Native2D__PvPvPUjssss,copy16BETo15BE__Pix16__PvPvPUjssss
	dc.l	rotate16BETo15BE__Pix16__PvPvPUjssss,copy16BETo15LE__Pix16__PvPvPUjssss,rotate16BETo15LE__Pix16__PvPvPUjssss,copy16XETo16XE__Pix16__PvPvPUjssss,rotate16BETo16BE__Pix16__PvPvPUjssss,copy16XETo16YE__Pix16__PvPvPUjssss,rotate16BETo16LE__Pix16__PvPvPUjssss,copy16BETo24XGY__Pix16__PvPvPUjssss,rotate16BETo24XGY__Pix16__PvPvPUjssss,copy16BETo32BE__Pix16__PvPvPUjssss,rotate16BETo32BE__Pix16__PvPvPUjssss
	dc.l	copy16BETo32LE__Pix16__PvPvPUjssss,rotate16BETo32LE__Pix16__PvPvPUjssss,none__Native2D__PvPvPUjssss,rotate16BETo15BE__Pix16__PvPvPUjssss,copy16BETo15BE__Pix16__PvPvPUjssss,rotate16BETo15LE__Pix16__PvPvPUjssss,copy16BETo15LE__Pix16__PvPvPUjssss,rotate16BETo16BE__Pix16__PvPvPUjssss,copy16XETo16XE__Pix16__PvPvPUjssss,rotate16BETo16LE__Pix16__PvPvPUjssss,copy16XETo16YE__Pix16__PvPvPUjssss
	dc.l	rotate16BETo24XGY__Pix16__PvPvPUjssss,copy16BETo24XGY__Pix16__PvPvPUjssss,rotate16BETo32BE__Pix16__PvPvPUjssss,copy16BETo32BE__Pix16__PvPvPUjssss,rotate16BETo32LE__Pix16__PvPvPUjssss,copy16BETo32LE__Pix16__PvPvPUjssss,none__Native2D__PvPvPUjssss,copy16LETo15BE__Pix16__PvPvPUjssss,rotate16LETo15BE__Pix16__PvPvPUjssss,copy16LETo15LE__Pix16__PvPvPUjssss,rotate16LETo15LE__Pix16__PvPvPUjssss
	dc.l	copy16XETo16YE__Pix16__PvPvPUjssss,rotate16LETo16BE__Pix16__PvPvPUjssss,copy16XETo16XE__Pix16__PvPvPUjssss,rotate16LETo16LE__Pix16__PvPvPUjssss,copy16LETo24XGY__Pix16__PvPvPUjssss,rotate16LETo24XGY__Pix16__PvPvPUjssss,copy16LETo32BE__Pix16__PvPvPUjssss,rotate16LETo32BE__Pix16__PvPvPUjssss,copy16LETo32LE__Pix16__PvPvPUjssss,rotate16LETo32LE__Pix16__PvPvPUjssss,none__Native2D__PvPvPUjssss
	dc.l	rotate16LETo15BE__Pix16__PvPvPUjssss,copy16LETo15BE__Pix16__PvPvPUjssss,rotate16LETo15LE__Pix16__PvPvPUjssss,copy16LETo15LE__Pix16__PvPvPUjssss,rotate16LETo16BE__Pix16__PvPvPUjssss,copy16XETo16YE__Pix16__PvPvPUjssss,rotate16LETo16LE__Pix16__PvPvPUjssss,copy16XETo16XE__Pix16__PvPvPUjssss,rotate16LETo24XGY__Pix16__PvPvPUjssss,copy16LETo24XGY__Pix16__PvPvPUjssss,rotate16LETo32BE__Pix16__PvPvPUjssss
	dc.l	copy16LETo32BE__Pix16__PvPvPUjssss,rotate16LETo32LE__Pix16__PvPvPUjssss,copy16LETo32LE__Pix16__PvPvPUjssss,none__Native2D__PvPvPUjssss,copy24XGYTo15BE__Pix24__PvPvPUjssss,rotate24XGYTo15BE__Pix24__PvPvPUjssss,copy24XGYTo15LE__Pix24__PvPvPUjssss,rotate24XGYTo15LE__Pix24__PvPvPUjssss,copy24XGYTo16BE__Pix24__PvPvPUjssss,rotate24XGYTo16BE__Pix24__PvPvPUjssss,copy24XGYTo16LE__Pix24__PvPvPUjssss
	dc.l	rotate24XGYTo16LE__Pix24__PvPvPUjssss,copy24To24__Pix24__PvPvPUjssss,rotate24To24__Pix24__PvPvPUjssss,copy24XGYTo32BE__Pix24__PvPvPUjssss,rotate24XGYTo32BE__Pix24__PvPvPUjssss,copy24XGYTo32LE__Pix24__PvPvPUjssss,rotate24XGYTo32LE__Pix24__PvPvPUjssss,none__Native2D__PvPvPUjssss,rotate24XGYTo15BE__Pix24__PvPvPUjssss,copy24XGYTo15BE__Pix24__PvPvPUjssss,rotate24XGYTo15LE__Pix24__PvPvPUjssss
	dc.l	copy24XGYTo15LE__Pix24__PvPvPUjssss,rotate24XGYTo16BE__Pix24__PvPvPUjssss,copy24XGYTo16BE__Pix24__PvPvPUjssss,rotate24XGYTo16LE__Pix24__PvPvPUjssss,copy24XGYTo16LE__Pix24__PvPvPUjssss,rotate24To24__Pix24__PvPvPUjssss,copy24To24__Pix24__PvPvPUjssss,rotate24XGYTo32BE__Pix24__PvPvPUjssss,copy24XGYTo32BE__Pix24__PvPvPUjssss,rotate24XGYTo32LE__Pix24__PvPvPUjssss,copy24XGYTo32LE__Pix24__PvPvPUjssss
	dc.l	none__Native2D__PvPvPUjssss,copy32BETo15BE__Pix32__PvPvPUjssss,rotate32BETo15BE__Pix32__PvPvPUjssss,copy32BETo15LE__Pix32__PvPvPUjssss,rotate32BETo15LE__Pix32__PvPvPUjssss,copy32BETo16BE__Pix32__PvPvPUjssss,rotate32BETo16BE__Pix32__PvPvPUjssss,copy32BETo16LE__Pix32__PvPvPUjssss,rotate32BETo16LE__Pix32__PvPvPUjssss,copy32BETo24XGY__Pix32__PvPvPUjssss,rotate32BETo24XGY__Pix32__PvPvPUjssss
	dc.l	copy32XETo32XE__Pix32__PvPvPUjssss,rotate32BETo32BE__Pix32__PvPvPUjssss,copy32XETo32YE__Pix32__PvPvPUjssss,rotate32BETo32LE__Pix32__PvPvPUjssss,none__Native2D__PvPvPUjssss,rotate32BETo15BE__Pix32__PvPvPUjssss,copy32BETo15BE__Pix32__PvPvPUjssss,rotate32BETo15LE__Pix32__PvPvPUjssss,copy32BETo15LE__Pix32__PvPvPUjssss,rotate32BETo16BE__Pix32__PvPvPUjssss,copy32BETo16BE__Pix32__PvPvPUjssss
	dc.l	rotate32BETo16LE__Pix32__PvPvPUjssss,copy32BETo16LE__Pix32__PvPvPUjssss,rotate32BETo24XGY__Pix32__PvPvPUjssss,copy32BETo24XGY__Pix32__PvPvPUjssss,rotate32BETo32BE__Pix32__PvPvPUjssss,copy32XETo32XE__Pix32__PvPvPUjssss,rotate32BETo32LE__Pix32__PvPvPUjssss,copy32XETo32YE__Pix32__PvPvPUjssss,none__Native2D__PvPvPUjssss,copy32LETo15BE__Pix32__PvPvPUjssss,rotate32LETo15BE__Pix32__PvPvPUjssss
	dc.l	copy32LETo15LE__Pix32__PvPvPUjssss,rotate32LETo15LE__Pix32__PvPvPUjssss,copy32LETo16BE__Pix32__PvPvPUjssss,rotate32LETo16BE__Pix32__PvPvPUjssss,copy32LETo16LE__Pix32__PvPvPUjssss,rotate32LETo16LE__Pix32__PvPvPUjssss,copy32LETo24XGY__Pix32__PvPvPUjssss,rotate32LETo24XGY__Pix32__PvPvPUjssss,rotate32LETo32BE__Pix32__PvPvPUjssss,copy32XETo32YE__Pix32__PvPvPUjssss,rotate32LETo32LE__Pix32__PvPvPUjssss
	dc.l	copy32XETo32XE__Pix32__PvPvPUjssss,none__Native2D__PvPvPUjssss,rotate32LETo15BE__Pix32__PvPvPUjssss,copy32LETo15BE__Pix32__PvPvPUjssss,rotate32LETo15LE__Pix32__PvPvPUjssss,copy32LETo15LE__Pix32__PvPvPUjssss,rotate32LETo16BE__Pix32__PvPvPUjssss,copy32LETo16BE__Pix32__PvPvPUjssss,rotate32LETo16LE__Pix32__PvPvPUjssss,copy32LETo16LE__Pix32__PvPvPUjssss,rotate32LETo24XGY__Pix32__PvPvPUjssss
	dc.l	copy32LETo24XGY__Pix32__PvPvPUjssss,copy32XETo32YE__Pix32__PvPvPUjssss,rotate32LETo32BE__Pix32__PvPvPUjssss,copy32XETo32XE__Pix32__PvPvPUjssss,rotate32LETo32LE__Pix32__PvPvPUjssss

	END
